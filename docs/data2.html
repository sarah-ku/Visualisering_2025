<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitel 6 Bearbejdning - tidyverse dag 2 | Analyse og visualisering af biologiske datasæt – 2025</title>
  <meta name="description" content="Course materials for Analyse og visualisering af biologiske datasæt 2025" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitel 6 Bearbejdning - tidyverse dag 2 | Analyse og visualisering af biologiske datasæt – 2025" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/ai_cover.jpeg" />
  <meta property="og:description" content="Course materials for Analyse og visualisering af biologiske datasæt 2025" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitel 6 Bearbejdning - tidyverse dag 2 | Analyse og visualisering af biologiske datasæt – 2025" />
  
  <meta name="twitter:description" content="Course materials for Analyse og visualisering af biologiske datasæt 2025" />
  <meta name="twitter:image" content="/ai_cover.jpeg" />

<meta name="author" content="Sarah Rennie" />


<meta name="date" content="2025-05-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data.html"/>
<link rel="next" href="functional-programming-med-purrr-pakken.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Visualisering_2025</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Lidt om kurset</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bedømmelse"><i class="fa fa-check"></i>Bedømmelse</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bare-lidt-om-underviserne"><i class="fa fa-check"></i>Bare lidt om underviserne</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="baser.html"><a href="baser.html"><i class="fa fa-check"></i><b>1</b> Grundlæggende R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="baser.html"><a href="baser.html#inledning-til-kapitel"><i class="fa fa-check"></i><b>1.1</b> Inledning til kapitel</a></li>
<li class="chapter" data-level="1.2" data-path="baser.html"><a href="baser.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="baser.html"><a href="baser.html#de-forskellige-vinduer-i-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> De forskellige vinduer i RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="baser.html"><a href="baser.html#working-directory"><i class="fa fa-check"></i><b>1.3</b> Working directory</a></li>
<li class="chapter" data-level="1.4" data-path="baser.html"><a href="baser.html#r-pakker"><i class="fa fa-check"></i><b>1.4</b> R pakker</a></li>
<li class="chapter" data-level="1.5" data-path="baser.html"><a href="baser.html#hvor-kommer-vores-data-fra"><i class="fa fa-check"></i><b>1.5</b> Hvor kommer vores data fra?</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="baser.html"><a href="baser.html#indbyggede-datasæt"><i class="fa fa-check"></i><b>1.5.1</b> Indbyggede datasæt</a></li>
<li class="chapter" data-level="1.5.2" data-path="baser.html"><a href="baser.html#importering-af-data-fra-.txt-fil"><i class="fa fa-check"></i><b>1.5.2</b> Importering af data fra .txt fil</a></li>
<li class="chapter" data-level="1.5.3" data-path="baser.html"><a href="baser.html#importering-af-data-fra-excel"><i class="fa fa-check"></i><b>1.5.3</b> Importering af data fra Excel</a></li>
<li class="chapter" data-level="1.5.4" data-path="baser.html"><a href="baser.html#kaggle"><i class="fa fa-check"></i><b>1.5.4</b> Kaggle</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="baser.html"><a href="baser.html#beregninger-i-r"><i class="fa fa-check"></i><b>1.6</b> Beregninger i R</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="baser.html"><a href="baser.html#objektor"><i class="fa fa-check"></i><b>1.6.1</b> Objektor</a></li>
<li class="chapter" data-level="1.6.2" data-path="baser.html"><a href="baser.html#vectorer"><i class="fa fa-check"></i><b>1.6.2</b> Vectorer</a></li>
<li class="chapter" data-level="1.6.3" data-path="baser.html"><a href="baser.html#datatyper"><i class="fa fa-check"></i><b>1.6.3</b> datatyper</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="baser.html"><a href="baser.html#dataframes"><i class="fa fa-check"></i><b>1.7</b> Dataframes</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="baser.html"><a href="baser.html#delmængder-af-dataframes"><i class="fa fa-check"></i><b>1.7.1</b> Delmængder af dataframes</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="baser.html"><a href="baser.html#ifelse"><i class="fa fa-check"></i><b>1.8</b> If/else</a></li>
<li class="chapter" data-level="1.9" data-path="baser.html"><a href="baser.html#loops"><i class="fa fa-check"></i><b>1.9</b> Loops</a></li>
<li class="chapter" data-level="1.10" data-path="baser.html"><a href="baser.html#descriptive-statistics"><i class="fa fa-check"></i><b>1.10</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="baser.html"><a href="baser.html#simulere-data-fra-den-normale-fordeling"><i class="fa fa-check"></i><b>1.10.1</b> Simulere data fra den normale fordeling</a></li>
<li class="chapter" data-level="1.10.2" data-path="baser.html"><a href="baser.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>1.10.2</b> Measures of central tendency</a></li>
<li class="chapter" data-level="1.10.3" data-path="baser.html"><a href="baser.html#tapply"><i class="fa fa-check"></i><b>1.10.3</b> <code>tapply()</code></a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="baser.html"><a href="baser.html#statistike-tester"><i class="fa fa-check"></i><b>1.11</b> Statistike tester</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="baser.html"><a href="baser.html#p-værdien"><i class="fa fa-check"></i><b>1.11.1</b> P-værdien</a></li>
<li class="chapter" data-level="1.11.2" data-path="baser.html"><a href="baser.html#korrelation"><i class="fa fa-check"></i><b>1.11.2</b> Korrelation</a></li>
<li class="chapter" data-level="1.11.3" data-path="baser.html"><a href="baser.html#test-for-uafhængighed-chi-sq-test"><i class="fa fa-check"></i><b>1.11.3</b> Test for uafhængighed (chi-sq test)</a></li>
<li class="chapter" data-level="1.11.4" data-path="baser.html"><a href="baser.html#sample-t-test"><i class="fa fa-check"></i><b>1.11.4</b> 1 sample t-test</a></li>
<li class="chapter" data-level="1.11.5" data-path="baser.html"><a href="baser.html#sample-t-test-1"><i class="fa fa-check"></i><b>1.11.5</b> 2-sample t-test</a></li>
<li class="chapter" data-level="1.11.6" data-path="baser.html"><a href="baser.html#paired-t-test"><i class="fa fa-check"></i><b>1.11.6</b> Paired t-test</a></li>
<li class="chapter" data-level="1.11.7" data-path="baser.html"><a href="baser.html#anova-variansanalyse"><i class="fa fa-check"></i><b>1.11.7</b> ANOVA (variansanalyse)</a></li>
<li class="chapter" data-level="1.11.8" data-path="baser.html"><a href="baser.html#lineær-regression"><i class="fa fa-check"></i><b>1.11.8</b> Lineær regression</a></li>
<li class="chapter" data-level="1.11.9" data-path="baser.html"><a href="baser.html#r-squared-coefficient-of-determination"><i class="fa fa-check"></i><b>1.11.9</b> R-squared coefficient of determination</a></li>
<li class="chapter" data-level="1.11.10" data-path="baser.html"><a href="baser.html#antagelser---lineær-regression"><i class="fa fa-check"></i><b>1.11.10</b> Antagelser - lineær regression</a></li>
<li class="chapter" data-level="1.11.11" data-path="baser.html"><a href="baser.html#multiple-lineær-regression"><i class="fa fa-check"></i><b>1.11.11</b> Multiple lineær regression</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="baser.html"><a href="baser.html#problemstillinger"><i class="fa fa-check"></i><b>1.12</b> Problemstillinger</a>
<ul>
<li class="chapter" data-level="1.12.1" data-path="baser.html"><a href="baser.html#quiz---basics"><i class="fa fa-check"></i><b>1.12.1</b> Quiz - Basics</a></li>
<li class="chapter" data-level="1.12.2" data-path="baser.html"><a href="baser.html#grundlæggende-r"><i class="fa fa-check"></i><b>1.12.2</b> Grundlæggende R</a></li>
<li class="chapter" data-level="1.12.3" data-path="baser.html"><a href="baser.html#kort-analyse-med-reaktionstider"><i class="fa fa-check"></i><b>1.12.3</b> Kort analyse med reaktionstider</a></li>
<li class="chapter" data-level="1.12.4" data-path="baser.html"><a href="baser.html#øvelse-med-co2"><i class="fa fa-check"></i><b>1.12.4</b> Øvelse med CO2</a></li>
<li class="chapter" data-level="1.12.5" data-path="baser.html"><a href="baser.html#ekstra-øvelser-med-statistik-tests"><i class="fa fa-check"></i><b>1.12.5</b> Ekstra øvelser med statistik tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>2</b> Introduktion til R Markdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rmarkdown.html"><a href="rmarkdown.html#inledning-til-kapital"><i class="fa fa-check"></i><b>2.1</b> Inledning til kapital</a></li>
<li class="chapter" data-level="2.2" data-path="rmarkdown.html"><a href="rmarkdown.html#hvad-er-r-markdown"><i class="fa fa-check"></i><b>2.2</b> Hvad er R Markdown?</a></li>
<li class="chapter" data-level="2.3" data-path="rmarkdown.html"><a href="rmarkdown.html#installere-r-markdown"><i class="fa fa-check"></i><b>2.3</b> Installere R Markdown</a></li>
<li class="chapter" data-level="2.4" data-path="rmarkdown.html"><a href="rmarkdown.html#videodemonstrationer"><i class="fa fa-check"></i><b>2.4</b> Videodemonstrationer</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="rmarkdown.html"><a href="rmarkdown.html#video-1"><i class="fa fa-check"></i><b>2.4.1</b> Video 1</a></li>
<li class="chapter" data-level="2.4.2" data-path="rmarkdown.html"><a href="rmarkdown.html#video-2"><i class="fa fa-check"></i><b>2.4.2</b> Video 2</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="rmarkdown.html"><a href="rmarkdown.html#oprette-et-nyt-dokument-i-r-markdown"><i class="fa fa-check"></i><b>2.5</b> Oprette et nyt dokument i R Markdown</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="rmarkdown.html"><a href="rmarkdown.html#yaml"><i class="fa fa-check"></i><b>2.5.1</b> YAML</a></li>
<li class="chapter" data-level="2.5.2" data-path="rmarkdown.html"><a href="rmarkdown.html#globale-options"><i class="fa fa-check"></i><b>2.5.2</b> Globale options</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rmarkdown.html"><a href="rmarkdown.html#skrive-baseret-tekst"><i class="fa fa-check"></i><b>2.6</b> Skrive baseret tekst</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="rmarkdown.html"><a href="rmarkdown.html#headers"><i class="fa fa-check"></i><b>2.6.1</b> Headers</a></li>
<li class="chapter" data-level="2.6.2" data-path="rmarkdown.html"><a href="rmarkdown.html#liste"><i class="fa fa-check"></i><b>2.6.2</b> liste</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="rmarkdown.html"><a href="rmarkdown.html#knitte-kode"><i class="fa fa-check"></i><b>2.7</b> Knitte kode</a></li>
<li class="chapter" data-level="2.8" data-path="rmarkdown.html"><a href="rmarkdown.html#kode-chunks"><i class="fa fa-check"></i><b>2.8</b> Kode chunks</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="rmarkdown.html"><a href="rmarkdown.html#et-godt-råd-når-man-arbejder-med-chunks"><i class="fa fa-check"></i><b>2.8.1</b> Et godt råd når man arbejder med chunks</a></li>
<li class="chapter" data-level="2.8.2" data-path="rmarkdown.html"><a href="rmarkdown.html#chunk-indstillinger"><i class="fa fa-check"></i><b>2.8.2</b> Chunk indstillinger</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="rmarkdown.html"><a href="rmarkdown.html#r-beregninger-inden-for-teksten-i-dokumentet-inline-code"><i class="fa fa-check"></i><b>2.9</b> R beregninger inden for teksten i dokumentet (‘inline code’)</a></li>
<li class="chapter" data-level="2.10" data-path="rmarkdown.html"><a href="rmarkdown.html#working-directory-1"><i class="fa fa-check"></i><b>2.10</b> Working directory</a></li>
<li class="chapter" data-level="2.11" data-path="rmarkdown.html"><a href="rmarkdown.html#matematik"><i class="fa fa-check"></i><b>2.11</b> Matematik</a></li>
<li class="chapter" data-level="2.12" data-path="rmarkdown.html"><a href="rmarkdown.html#ofte-set-fejl"><i class="fa fa-check"></i><b>2.12</b> Ofte set fejl</a></li>
<li class="chapter" data-level="2.13" data-path="rmarkdown.html"><a href="rmarkdown.html#problemstillinger-1"><i class="fa fa-check"></i><b>2.13</b> Problemstillinger</a></li>
<li class="chapter" data-level="2.14" data-path="rmarkdown.html"><a href="rmarkdown.html#færdig-for-i-dag-og-næste-gang"><i class="fa fa-check"></i><b>2.14</b> Færdig for i dag og næste gang</a></li>
<li class="chapter" data-level="2.15" data-path="rmarkdown.html"><a href="rmarkdown.html#ekstra-links"><i class="fa fa-check"></i><b>2.15</b> Ekstra links</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visual1.html"><a href="visual1.html"><i class="fa fa-check"></i><b>3</b> Visualisering - ggplot2 dag 1</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visual1.html"><a href="visual1.html#læringsmålene-og-videoer"><i class="fa fa-check"></i><b>3.1</b> Læringsmålene og videoer</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="visual1.html"><a href="visual1.html#hvad-er-ggplot2"><i class="fa fa-check"></i><b>3.1.1</b> Hvad er <strong>ggplot2</strong>?</a></li>
<li class="chapter" data-level="3.1.2" data-path="visual1.html"><a href="visual1.html#brugen-af-materialerne"><i class="fa fa-check"></i><b>3.1.2</b> Brugen af materialerne</a></li>
<li class="chapter" data-level="3.1.3" data-path="visual1.html"><a href="visual1.html#video-ressourcer"><i class="fa fa-check"></i><b>3.1.3</b> Video ressourcer</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="visual1.html"><a href="visual1.html#transition-fra-base-r-til-ggplot2"><i class="fa fa-check"></i><b>3.2</b> Transition fra base R til ggplot2</a></li>
<li class="chapter" data-level="3.3" data-path="visual1.html"><a href="visual1.html#vores-første-ggplot"><i class="fa fa-check"></i><b>3.3</b> Vores første ggplot</a></li>
<li class="chapter" data-level="3.4" data-path="visual1.html"><a href="visual1.html#lidt-om-ggplot2"><i class="fa fa-check"></i><b>3.4</b> Lidt om ggplot2</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visual1.html"><a href="visual1.html#syntax"><i class="fa fa-check"></i><b>3.4.1</b> Syntax</a></li>
<li class="chapter" data-level="3.4.2" data-path="visual1.html"><a href="visual1.html#hvad-betyder-egentlig-grammar-of-graphics"><i class="fa fa-check"></i><b>3.4.2</b> Hvad betyder egentlig grammar of graphics?</a></li>
<li class="chapter" data-level="3.4.3" data-path="visual1.html"><a href="visual1.html#global-versus-lokal-æstetik"><i class="fa fa-check"></i><b>3.4.3</b> Global versus lokal æstetik</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visual1.html"><a href="visual1.html#specificere-etiketter-og-titel"><i class="fa fa-check"></i><b>3.5</b> Specificere etiketter og titel</a></li>
<li class="chapter" data-level="3.6" data-path="visual1.html"><a href="visual1.html#ændre-farver"><i class="fa fa-check"></i><b>3.6</b> Ændre farver</a></li>
<li class="chapter" data-level="3.7" data-path="visual1.html"><a href="visual1.html#ændre-tema"><i class="fa fa-check"></i><b>3.7</b> Ændre tema</a></li>
<li class="chapter" data-level="3.8" data-path="visual1.html"><a href="visual1.html#forskellige-geoms"><i class="fa fa-check"></i><b>3.8</b> Forskellige geoms</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="visual1.html"><a href="visual1.html#boxplot-geom_box"><i class="fa fa-check"></i><b>3.8.1</b> Boxplot (<code>geom_box</code>)</a></li>
<li class="chapter" data-level="3.8.2" data-path="visual1.html"><a href="visual1.html#barplot-geom_bar"><i class="fa fa-check"></i><b>3.8.2</b> Barplot (<code>geom_bar</code>)</a></li>
<li class="chapter" data-level="3.8.3" data-path="visual1.html"><a href="visual1.html#histogram-geom_histogram"><i class="fa fa-check"></i><b>3.8.3</b> Histogram (<code>geom_histogram</code>)</a></li>
<li class="chapter" data-level="3.8.4" data-path="visual1.html"><a href="visual1.html#density-geom_density"><i class="fa fa-check"></i><b>3.8.4</b> Density (<code>geom_density</code>)</a></li>
<li class="chapter" data-level="3.8.5" data-path="visual1.html"><a href="visual1.html#line-plot-geom_line"><i class="fa fa-check"></i><b>3.8.5</b> Line plot (<code>geom_line()</code>)</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="visual1.html"><a href="visual1.html#troubleshooting"><i class="fa fa-check"></i><b>3.9</b> Troubleshooting</a></li>
<li class="chapter" data-level="3.10" data-path="visual1.html"><a href="visual1.html#problemstillinger-2"><i class="fa fa-check"></i><b>3.10</b> Problemstillinger</a></li>
<li class="chapter" data-level="3.11" data-path="visual1.html"><a href="visual1.html#næste-gang"><i class="fa fa-check"></i><b>3.11</b> Næste gang</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visual2.html"><a href="visual2.html"><i class="fa fa-check"></i><b>4</b> Visualisering - ggplot2 dag 2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visual2.html"><a href="visual2.html#læringsmål-og-videoer"><i class="fa fa-check"></i><b>4.1</b> Læringsmål og videoer</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="visual2.html"><a href="visual2.html#video-ressourcer-1"><i class="fa fa-check"></i><b>4.1.1</b> Video ressourcer</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="visual2.html"><a href="visual2.html#koordinat-systemer"><i class="fa fa-check"></i><b>4.2</b> Koordinat systemer</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visual2.html"><a href="visual2.html#zoom-coord_cartesian-expand_limits"><i class="fa fa-check"></i><b>4.2.1</b> Zoom (<code>coord_cartesian()</code>, <code>expand_limits()</code>)</a></li>
<li class="chapter" data-level="4.2.2" data-path="visual2.html"><a href="visual2.html#transformering-af-akserne---log-sqrt-osv-scale_x_continuous."><i class="fa fa-check"></i><b>4.2.2</b> Transformering af akserne - log, sqrt osv (<code>scale_x_continuous</code>).</a></li>
<li class="chapter" data-level="4.2.3" data-path="visual2.html"><a href="visual2.html#flip-coordinates-coord_flip"><i class="fa fa-check"></i><b>4.2.3</b> Flip coordinates (<code>coord_flip</code>)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="visual2.html"><a href="visual2.html#mere-om-farver-og-punkt-former"><i class="fa fa-check"></i><b>4.3</b> Mere om farver og punkt former</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visual2.html"><a href="visual2.html#automatisk-farver"><i class="fa fa-check"></i><b>4.3.1</b> Automatisk farver</a></li>
<li class="chapter" data-level="4.3.2" data-path="visual2.html"><a href="visual2.html#manuelle-farver"><i class="fa fa-check"></i><b>4.3.2</b> Manuelle farver</a></li>
<li class="chapter" data-level="4.3.3" data-path="visual2.html"><a href="visual2.html#punkt-former"><i class="fa fa-check"></i><b>4.3.3</b> Punkt former</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visual2.html"><a href="visual2.html#annotations-geom_text"><i class="fa fa-check"></i><b>4.4</b> Annotations (<code>geom_text</code>)</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="visual2.html"><a href="visual2.html#tilføjelse-af-etiketter-direkte-på-plottet."><i class="fa fa-check"></i><b>4.4.1</b> Tilføjelse af etiketter direkte på plottet.</a></li>
<li class="chapter" data-level="4.4.2" data-path="visual2.html"><a href="visual2.html#pakken-ggrepel-for-at-tilføje-tekst-labeller"><i class="fa fa-check"></i><b>4.4.2</b> Pakken <code>ggrepel</code> for at tilføje tekst labeller</a></li>
<li class="chapter" data-level="4.4.3" data-path="visual2.html"><a href="visual2.html#tilføjelse-af-rektangler-i-regioner-af-interesse-annotate"><i class="fa fa-check"></i><b>4.4.3</b> Tilføjelse af rektangler i regioner af interesse (<code>annotate</code>)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="visual2.html"><a href="visual2.html#adskille-plots-med-facets-facet_gridfacet_wrap"><i class="fa fa-check"></i><b>4.5</b> Adskille plots med facets (<code>facet_grid</code>/<code>facet_wrap</code>)</a></li>
<li class="chapter" data-level="4.6" data-path="visual2.html"><a href="visual2.html#gemme-dit-plot"><i class="fa fa-check"></i><b>4.6</b> Gemme dit plot</a></li>
<li class="chapter" data-level="4.7" data-path="visual2.html"><a href="visual2.html#problemstillinger-3"><i class="fa fa-check"></i><b>4.7</b> Problemstillinger</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>5</b> Bearbejdning - tidyverse dag 1</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data.html"><a href="data.html#idéen-med-tidyverse"><i class="fa fa-check"></i><b>5.1</b> Idéen med tidyverse</a></li>
<li class="chapter" data-level="5.2" data-path="data.html"><a href="data.html#video-ressourcer-2"><i class="fa fa-check"></i><b>5.2</b> Video ressourcer</a></li>
<li class="chapter" data-level="5.3" data-path="data.html"><a href="data.html#oversigt-over-pakker"><i class="fa fa-check"></i><b>5.3</b> Oversigt over pakker</a></li>
<li class="chapter" data-level="5.4" data-path="data.html"><a href="data.html#principper-af-tidy-data"><i class="fa fa-check"></i><b>5.4</b> Principper af ‘tidy’ data</a></li>
<li class="chapter" data-level="5.5" data-path="data.html"><a href="data.html#lidt-om-tibbles"><i class="fa fa-check"></i><b>5.5</b> Lidt om <code>tibbles</code></a></li>
<li class="chapter" data-level="5.6" data-path="data.html"><a href="data.html#transition-fra-base-r-til-tidyverse"><i class="fa fa-check"></i><b>5.6</b> Transition fra base-R til tidyverse</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data.html"><a href="data.html#om-titanic-datasættet"><i class="fa fa-check"></i><b>5.6.1</b> Om <strong>Titanic</strong> datasættet</a></li>
<li class="chapter" data-level="5.6.2" data-path="data.html"><a href="data.html#titanic-rengøring"><i class="fa fa-check"></i><b>5.6.2</b> Titanic: Rengøring</a></li>
<li class="chapter" data-level="5.6.3" data-path="data.html"><a href="data.html#pipe"><i class="fa fa-check"></i><b>5.6.3</b> Pipe</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data.html"><a href="data.html#bearbejdning-af-data-dplyr"><i class="fa fa-check"></i><b>5.7</b> Bearbejdning af data: <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data.html"><a href="data.html#dplyr-verbs-select"><i class="fa fa-check"></i><b>5.7.1</b> dplyr verbs: <code>select()</code></a></li>
<li class="chapter" data-level="5.7.2" data-path="data.html"><a href="data.html#dplyr-verbs-filter"><i class="fa fa-check"></i><b>5.7.2</b> dplyr verbs: <code>filter()</code></a></li>
<li class="chapter" data-level="5.7.3" data-path="data.html"><a href="data.html#sammenligningsoperatorer"><i class="fa fa-check"></i><b>5.7.3</b> Sammenligningsoperatorer</a></li>
<li class="chapter" data-level="5.7.4" data-path="data.html"><a href="data.html#kombinere-filter-og-select"><i class="fa fa-check"></i><b>5.7.4</b> Kombinere <code>filter()</code> og <code>select()</code></a></li>
<li class="chapter" data-level="5.7.5" data-path="data.html"><a href="data.html#dplyr-verbs-mutate"><i class="fa fa-check"></i><b>5.7.5</b> dplyr verbs: <code>mutate()</code></a></li>
<li class="chapter" data-level="5.7.6" data-path="data.html"><a href="data.html#rename"><i class="fa fa-check"></i><b>5.7.6</b> <code>rename()</code></a></li>
<li class="chapter" data-level="5.7.7" data-path="data.html"><a href="data.html#dplyr-verbs-recode"><i class="fa fa-check"></i><b>5.7.7</b> dplyr verbs: <code>recode()</code></a></li>
<li class="chapter" data-level="5.7.8" data-path="data.html"><a href="data.html#dplyr-verbs-arrange"><i class="fa fa-check"></i><b>5.7.8</b> dplyr verbs: <code>arrange()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data.html"><a href="data.html#visualisering-bruge-som-input-i-ggplot2"><i class="fa fa-check"></i><b>5.8</b> Visualisering: bruge som input i ggplot2</a></li>
<li class="chapter" data-level="5.9" data-path="data.html"><a href="data.html#ekstra-funktioner-som-er-nyttige-at-vide"><i class="fa fa-check"></i><b>5.9</b> Ekstra funktioner som er nyttige at vide</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="data.html"><a href="data.html#pull"><i class="fa fa-check"></i><b>5.9.1</b> Pull</a></li>
<li class="chapter" data-level="5.9.2" data-path="data.html"><a href="data.html#slice"><i class="fa fa-check"></i><b>5.9.2</b> Slice</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="data.html"><a href="data.html#problemstillinger-4"><i class="fa fa-check"></i><b>5.10</b> Problemstillinger</a></li>
<li class="chapter" data-level="5.11" data-path="data.html"><a href="data.html#kommentarer"><i class="fa fa-check"></i><b>5.11</b> Kommentarer</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data2.html"><a href="data2.html"><i class="fa fa-check"></i><b>6</b> Bearbejdning - tidyverse dag 2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data2.html"><a href="data2.html#introduktion-og-læringsmålene"><i class="fa fa-check"></i><b>6.1</b> Introduktion og læringsmålene</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data2.html"><a href="data2.html#læringsmålene"><i class="fa fa-check"></i><b>6.1.1</b> Læringsmålene</a></li>
<li class="chapter" data-level="6.1.2" data-path="data2.html"><a href="data2.html#videoer"><i class="fa fa-check"></i><b>6.1.2</b> Videoer</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data2.html"><a href="data2.html#kombinationen-af-group_by-og-summarise-i-dplyr-pakken"><i class="fa fa-check"></i><b>6.2</b> Kombinationen af <code>group_by()</code> og <code>summarise()</code> i <code>dplyr</code>-pakken</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="data2.html"><a href="data2.html#reference-af-summarise-funktioner"><i class="fa fa-check"></i><b>6.2.1</b> Reference af <code>summarise()</code>-funktioner</a></li>
<li class="chapter" data-level="6.2.2" data-path="data2.html"><a href="data2.html#flere-summeringsstatistikker-på-én-gang"><i class="fa fa-check"></i><b>6.2.2</b> Flere summeringsstatistikker på én gang</a></li>
<li class="chapter" data-level="6.2.3" data-path="data2.html"><a href="data2.html#mere-avanceret-group_by"><i class="fa fa-check"></i><b>6.2.3</b> Mere avanceret <code>group_by()</code></a></li>
<li class="chapter" data-level="6.2.4" data-path="data2.html"><a href="data2.html#funktionen-ungroup"><i class="fa fa-check"></i><b>6.2.4</b> Funktionen <code>ungroup()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data2.html"><a href="data2.html#pivot_longerpivot_wider-fra-tidyr-pakken"><i class="fa fa-check"></i><b>6.3</b> <code>pivot_longer()</code>/<code>pivot_wider()</code> fra <code>tidyr</code>-pakken</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="data2.html"><a href="data2.html#oversigt-over-tidyr-pakken"><i class="fa fa-check"></i><b>6.3.1</b> Oversigt over <code>tidyr</code> pakken</a></li>
<li class="chapter" data-level="6.3.2" data-path="data2.html"><a href="data2.html#reshape-data-fra-wide-til-long-med-pivot_longer"><i class="fa fa-check"></i><b>6.3.2</b> Reshape data fra wide til long med <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="data2.html"><a href="data2.html#separate"><i class="fa fa-check"></i><b>6.3.3</b> <code>separate()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="data2.html"><a href="data2.html#eksempel-titanic-opsummeringsstatistikker"><i class="fa fa-check"></i><b>6.4</b> Eksempel: Titanic opsummeringsstatistikker</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="data2.html"><a href="data2.html#pivot_wider"><i class="fa fa-check"></i><b>6.4.1</b> <code>pivot_wider()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="data2.html"><a href="data2.html#left_join-forbinde-dataframes"><i class="fa fa-check"></i><b>6.5</b> <code>left_join()</code>: forbinde dataframes</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="data2.html"><a href="data2.html#left_join-fra-dplyr-pakken"><i class="fa fa-check"></i><b>6.5.1</b> <code>left_join()</code> fra dplyr-pakken</a></li>
<li class="chapter" data-level="6.5.2" data-path="data2.html"><a href="data2.html#anvend-left_join-på-vores-datasæt."><i class="fa fa-check"></i><b>6.5.2</b> Anvend <code>left_join()</code> på vores datasæt.</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="data2.html"><a href="data2.html#problemstillinger-5"><i class="fa fa-check"></i><b>6.6</b> Problemstillinger</a></li>
<li class="chapter" data-level="6.7" data-path="data2.html"><a href="data2.html#ekstra-links-1"><i class="fa fa-check"></i><b>6.7</b> Ekstra links</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html"><i class="fa fa-check"></i><b>7</b> Functional programming med purrr-pakken</a>
<ul>
<li class="chapter" data-level="7.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#inledning-og-læringsmålene"><i class="fa fa-check"></i><b>7.1</b> Inledning og læringsmålene</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#videorressourcer"><i class="fa fa-check"></i><b>7.1.1</b> Videorressourcer</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#iterative-processer-med-map-funktioner"><i class="fa fa-check"></i><b>7.2</b> Iterative processer med <code>map()</code> funktioner</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#introduktion-til-map-funktioner"><i class="fa fa-check"></i><b>7.2.1</b> Introduktion til <code>map()</code> funktioner</a></li>
<li class="chapter" data-level="7.2.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#reference-for-de-forskellige-map-funktioner"><i class="fa fa-check"></i><b>7.2.2</b> Reference for de forskellige map-funktioner</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#brugerdefinerede-funktioner"><i class="fa fa-check"></i><b>7.3</b> Brugerdefinerede funktioner</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#simple-funktioner"><i class="fa fa-check"></i><b>7.3.1</b> Simple funktioner</a></li>
<li class="chapter" data-level="7.3.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#brugerdefinerede-funktioner-med-mapping"><i class="fa fa-check"></i><b>7.3.2</b> Brugerdefinerede funktioner med mapping</a></li>
<li class="chapter" data-level="7.3.3" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#effekten-af-map-på-andre-datatyper"><i class="fa fa-check"></i><b>7.3.3</b> Effekten af <code>map</code> på andre datatyper</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#nesting-med-nest"><i class="fa fa-check"></i><b>7.4</b> Nesting med <code>nest()</code></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#anvendelse-af-map-med-nested-data"><i class="fa fa-check"></i><b>7.4.1</b> Anvendelse af map() med nested data</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#andre-brugbar-purrr"><i class="fa fa-check"></i><b>7.5</b> Andre brugbar purrr</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#map2-funktion-for-flere-inputs"><i class="fa fa-check"></i><b>7.5.1</b> <code>map2()</code> funktion for flere inputs</a></li>
<li class="chapter" data-level="7.5.2" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#transformering-af-numeriske-variabler"><i class="fa fa-check"></i><b>7.5.2</b> Transformering af numeriske variabler</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#problemstillinger-6"><i class="fa fa-check"></i><b>7.6</b> Problemstillinger</a></li>
<li class="chapter" data-level="7.7" data-path="functional-programming-med-purrr-pakken.html"><a href="functional-programming-med-purrr-pakken.html#ekstra-notater-og-næste-gang"><i class="fa fa-check"></i><b>7.7</b> Ekstra notater og næste gang</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://sarah-ku.github.io/Visualisering_2025" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyse og visualisering af biologiske datasæt – 2025</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data2" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Kapitel 6</span> Bearbejdning - tidyverse dag 2<a href="data2.html#data2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="plots/hex-tidyverse.png" width="15%" style="display: block; margin: auto;" /></p>
<p>“Fejl ved brug af utilstrækkelige data er meget mindre end når man ikke bruger nogen data overhovedet.” – Charles Babbage</p>
<div id="introduktion-og-læringsmålene" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Introduktion og læringsmålene<a href="data2.html#introduktion-og-læringsmålene" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I dag fortsætter vi arbejdet med <code>tidyverse</code>. Vi fokuserer især på pakkerne <code>dplyr</code> og <code>tidyr</code>, som kan bruges til at ændre strukturen af et datasæt. Det hjælper blandt andet med at tilpasse data til den krævede struktur for at lave plots med <code>ggplot2</code>.</p>
<p>I biologi er det ofte tilfældet at dataene er i een dataframe mens yderligere oplysninger om prøverne er i en anden dataframe. Derfor vil vi gerne lære, hvordan man forbinder disse dataframes i R. At integrere datasæt hjælper med visualisering af ekstra informationer i jeres plots.</p>
<div id="læringsmålene" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Læringsmålene<a href="data2.html#læringsmålene" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="goals">
<p>Du skal kunne:</p>
<ul>
<li>Bruge kombinationen af <code>group_by()</code> og <code>summarise()</code>.</li>
<li>Forstå forskellen mellem <code>wide</code> og <code>long</code> data og bruge <code>pivot_longer()</code> til at lette plotting.</li>
<li>Bruge <code>left_join()</code> eller andre join-funktioner til at tilføje prøveinformation til datasættet.</li>
</ul>
</div>
<div class="checklist">
<ul>
<li>Se videoerne</li>
<li>Lav quiz på Absalon (‘tidyverse - dag 2’)</li>
<li>Lav problemstillingerne</li>
</ul>
</div>
</div>
<div id="videoer" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Videoer<a href="data2.html#videoer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Video 1: Kombination af <code>group_by()</code> og <code>summarise()</code>. Forbinde <code>tidyverse</code> og <code>ggplot2</code> kode sammen via <code>%&gt;%</code> / <code>+</code>.</li>
</ul>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/546910681" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<hr />
<ul>
<li>Video 2: Wide/long dataformat, <code>pivot_longer()</code> og deres brug i ggplot2.</li>
</ul>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/707081191" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<hr />
<ul>
<li>Video 3: <code>titanic</code> summary statistics eksempel.</li>
</ul>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/707223997" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<hr />
<ul>
<li>Video 4: <code>left_join()</code> for at forbinde tabeller med ekstra oplysninger.</li>
</ul>
<div class="vembedr">
<div>
<iframe class="vimeo-embed" src="https://player.vimeo.com/video/707082269" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
</div>
<div id="kombinationen-af-group_by-og-summarise-i-dplyr-pakken" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Kombinationen af <code>group_by()</code> og <code>summarise()</code> i <code>dplyr</code>-pakken<a href="data2.html#kombinationen-af-group_by-og-summarise-i-dplyr-pakken" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ved at kombinere <code>group_by()</code> og <code>summarise()</code> kan man finde numeriske svar på spørgsmålet: Havde mænd eller kvinder en højere sandsynlighed for at overleve tragedien?</p>
<p>Lad os starte med at se på en løsning med <code>tapply</code>, hvor vi udregner proportionen af mænd og kvinder der overlevede. Følgende kode opdeler variablen <code>Survived</code> efter den kategoriske variabel <code>Sex</code> og tager det aritmetiske gennemsnit. Dermed får vi proportionen af overlevende efter køn. Vi kan beregne gennemsnittet på den måde, fordi <code>1</code> betyder at man overlevede, <code>0</code> betyder at man ikke overlevede og at man kan anvende disse numeriske værdier matematisk.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="data2.html#cb308-1" tabindex="-1"></a>titanic_clean <span class="ot">&lt;-</span> titanic <span class="sc">%&gt;%</span> </span>
<span id="cb308-2"><a href="data2.html#cb308-2" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Cabin) <span class="sc">%&gt;%</span></span>
<span id="cb308-3"><a href="data2.html#cb308-3" tabindex="-1"></a>    <span class="fu">drop_na</span>()</span>
<span id="cb308-4"><a href="data2.html#cb308-4" tabindex="-1"></a></span>
<span id="cb308-5"><a href="data2.html#cb308-5" tabindex="-1"></a><span class="co">#tapply løsning </span></span>
<span id="cb308-6"><a href="data2.html#cb308-6" tabindex="-1"></a><span class="fu">tapply</span>(titanic_clean<span class="sc">$</span>Survived,titanic_clean<span class="sc">$</span>Sex,mean)</span></code></pre></div>
<pre><code>#&gt;    female      male 
#&gt; 0.7547893 0.2052980</code></pre>
<p>Nu skifter vi over til en <code>tidyverse</code>-løsning. Lad os tage udgangspunkt i <code>summarise()</code>-funktionen. Vi vil beregne en variabel, som hedder “medianFare” og som er identisk med <code>median(Fare)</code>.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="data2.html#cb310-1" tabindex="-1"></a>titanic_clean <span class="sc">%&gt;%</span></span>
<span id="cb310-2"><a href="data2.html#cb310-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;medianFare&quot;</span> <span class="ot">=</span> <span class="fu">median</span>(Fare))</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 × 1
#&gt;   medianFare
#&gt;        &lt;dbl&gt;
#&gt; 1       15.7</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="data2.html#cb312-1" tabindex="-1"></a>  <span class="co"># summarise(medianFare = median(Fare))</span></span></code></pre></div>
<p>Vi får faktisk en ny dataframe her med kun den variabel vi lige har specificeret. Vi er dog interesseret i proportionen af overlevende, så vi tager gennemsnittet af variablen <code>Survived</code>. Lad os gøre det med <code>summarise()</code>:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="data2.html#cb313-1" tabindex="-1"></a>titanic_clean <span class="sc">%&gt;%</span>  </span>
<span id="cb313-2"><a href="data2.html#cb313-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanSurvived =</span> <span class="fu">mean</span>(Survived))</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 × 1
#&gt;   meanSurvived
#&gt;          &lt;dbl&gt;
#&gt; 1        0.406</code></pre>
<p>For at besvare spørgsmålet er vi også nødt til at opdele efter kolonnen <code>Sex</code>. Vi kan bruge kombinationen af <code>group_by()</code> og <code>summarise()</code>. Vi opdeler efter <code>Sex</code> ved at anvende funktionen <code>group_by()</code> og derefter bruger vi <code>summarise()</code> til at oprette en kolonne, der hedder <code>meanSurvived</code>, som viser proportionen af overlevende for både kvinder og mænd.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="data2.html#cb315-1" tabindex="-1"></a><span class="co">#tidyverse løsning</span></span>
<span id="cb315-2"><a href="data2.html#cb315-2" tabindex="-1"></a>titanic_clean <span class="sc">%&gt;%</span></span>
<span id="cb315-3"><a href="data2.html#cb315-3" tabindex="-1"></a>    <span class="fu">group_by</span>(Sex) <span class="sc">%&gt;%</span></span>
<span id="cb315-4"><a href="data2.html#cb315-4" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">meanSurvived =</span> <span class="fu">mean</span>(Survived))</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 × 2
#&gt;   Sex    meanSurvived
#&gt;   &lt;chr&gt;         &lt;dbl&gt;
#&gt; 1 female        0.755
#&gt; 2 male          0.205</code></pre>
<p>Lad os tage resultatet fra ovenstående kode chunk og visualisere det i et barplot / sølediagram:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="data2.html#cb317-1" tabindex="-1"></a>titanic_clean <span class="sc">%&gt;%</span>  </span>
<span id="cb317-2"><a href="data2.html#cb317-2" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex) <span class="sc">%&gt;%</span> </span>
<span id="cb317-3"><a href="data2.html#cb317-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanSurvived =</span> <span class="fu">mean</span>(Survived)) <span class="sc">%&gt;%</span></span>
<span id="cb317-4"><a href="data2.html#cb317-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> meanSurvived, <span class="at">fill =</span> Sex)) <span class="sc">+</span> </span>
<span id="cb317-5"><a href="data2.html#cb317-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb317-6"><a href="data2.html#cb317-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="06-tidyverse2_files/figure-html/unnamed-chunk-11-1.svg" width="288" style="display: block; margin: auto;" /></p>
<div id="reference-af-summarise-funktioner" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Reference af <code>summarise()</code>-funktioner<a href="data2.html#reference-af-summarise-funktioner" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Her er nogle funktioner, som man ofte bruger med <code>summarise()</code> (der er mange andre muligheder).</p>
<table>
<thead>
<tr class="header">
<th>Funktion</th>
<th>Beskrivelse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>mean()</code></td>
<td>beregner gennemsnittet af en variabel (i en gruppe).</td>
</tr>
<tr class="even">
<td><code>sd()</code></td>
<td>beregner standardafvigelsen af en variabel (i en gruppe).</td>
</tr>
<tr class="odd">
<td><code>min()</code></td>
<td>finder den laveste værdi af en variabel (i en gruppe).</td>
</tr>
<tr class="even">
<td><code>max()</code></td>
<td>finder den højeste værdi af en variabel (i en gruppe).</td>
</tr>
<tr class="odd">
<td><code>n()</code></td>
<td>taler observationer i en gruppe eller variabel.</td>
</tr>
<tr class="even">
<td><code>first()</code></td>
<td>vælger den første værdi af en variabel (i en gruppe).</td>
</tr>
</tbody>
</table>
</div>
<div id="flere-summeringsstatistikker-på-én-gang" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Flere summeringsstatistikker på én gang<a href="data2.html#flere-summeringsstatistikker-på-én-gang" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vi kan også lave flere summeringsstatistikker på én gang. F.eks. kan vi anvende funktionen <code>group_by</code> med <code>Sex</code> igen, men beregne flere forskellige summeringsstatistikker:</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="data2.html#cb318-1" tabindex="-1"></a>titanic_clean_summary_by_sex <span class="ot">&lt;-</span> titanic_clean <span class="sc">%&gt;%</span>  </span>
<span id="cb318-2"><a href="data2.html#cb318-2" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex) <span class="sc">%&gt;%</span> </span>
<span id="cb318-3"><a href="data2.html#cb318-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(),                    <span class="co">#count</span></span>
<span id="cb318-4"><a href="data2.html#cb318-4" tabindex="-1"></a>            <span class="at">meanSurvived =</span> <span class="fu">mean</span>(Survived),  <span class="co">#middelværdi survived</span></span>
<span id="cb318-5"><a href="data2.html#cb318-5" tabindex="-1"></a>            <span class="at">meanAge =</span> <span class="fu">mean</span>(Age),            <span class="co">#middelværdi age</span></span>
<span id="cb318-6"><a href="data2.html#cb318-6" tabindex="-1"></a>            <span class="at">propFirst =</span> <span class="fu">sum</span>(Pclass<span class="sc">==</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">n</span>()) <span class="co">#proportionen i første klass</span></span>
<span id="cb318-7"><a href="data2.html#cb318-7" tabindex="-1"></a>titanic_clean_summary_by_sex</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 × 5
#&gt;   Sex    count meanSurvived meanAge propFirst
#&gt;   &lt;chr&gt;  &lt;int&gt;        &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
#&gt; 1 female   261        0.755    27.9     0.326
#&gt; 2 male     453        0.205    30.7     0.223</code></pre>
<p>Denne summeringstabel kan bruges igen som et datasæt til at lave et diagram med <code>ggplot2</code>. Bemærk, at her bruger vi <code>stat="identity"</code>, fordi vi skal ikke tælle observationerne op længere, men bare plotte præcis de tal som allerede er i dataframen. I nedenstående eksempel laver vi søjlediagrammer for <code>meanAge</code> og <code>propFirst</code>. De er plottet ved hjælp af to forskellige <code>ggplot</code>-kommandoer og ved siden af hinanden ved hjælp af en funktion kaldet <code>grid.arrange()</code> fra R-pakken <code>gridExtra</code>.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="data2.html#cb320-1" tabindex="-1"></a>plotA <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>titanic_clean_summary_by_sex,<span class="fu">aes</span>(<span class="at">x=</span>Sex,<span class="at">y=</span>meanAge,<span class="at">fill=</span>Sex)) <span class="sc">+</span> </span>
<span id="cb320-2"><a href="data2.html#cb320-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb320-3"><a href="data2.html#cb320-3" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb320-4"><a href="data2.html#cb320-4" tabindex="-1"></a></span>
<span id="cb320-5"><a href="data2.html#cb320-5" tabindex="-1"></a>plotB <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>titanic_clean_summary_by_sex,<span class="fu">aes</span>(<span class="at">x=</span>Sex,<span class="at">y=</span>propFirst,<span class="at">fill=</span>Sex)) <span class="sc">+</span> </span>
<span id="cb320-6"><a href="data2.html#cb320-6" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb320-7"><a href="data2.html#cb320-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb320-8"><a href="data2.html#cb320-8" tabindex="-1"></a></span>
<span id="cb320-9"><a href="data2.html#cb320-9" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb320-10"><a href="data2.html#cb320-10" tabindex="-1"></a><span class="fu">grid.arrange</span>(plotA,plotB,<span class="at">ncol=</span><span class="dv">2</span>) <span class="co">#plot both together</span></span></code></pre></div>
<p><img src="06-tidyverse2_files/figure-html/unnamed-chunk-13-1.svg" width="480" style="display: block; margin: auto;" /></p>
<p>Vi kan se at kvinder var i gennemsnit lidt yngre end mænd og havde en højere sandsynlighed for at være i første klasse.</p>
<p>Et interessant spørgsmål er, hvordan man kan lave de ovenstående plots uden at bruge to forskellige <code>ggplot</code>-kommandoer. Med andre ord, hvordan man kan lave en automatisk løsning, hvor vi kan plotte flere summeringsstatistikker med kun én <code>ggplot</code>-kommando. Vi kommer til at se senere hvordan det kan gøres ved først at konvertere datasættet til long-formatet.</p>
</div>
<div id="mere-avanceret-group_by" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Mere avanceret <code>group_by()</code><a href="data2.html#mere-avanceret-group_by" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lad os også beregne, hvor mange passagerer der var, efter deres klasse og steden hvor de gik ombord på skibet:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="data2.html#cb321-1" tabindex="-1"></a>titanic_clean <span class="sc">%&gt;%</span></span>
<span id="cb321-2"><a href="data2.html#cb321-2" tabindex="-1"></a>   <span class="fu">group_by</span>(Embarked, Pclass) <span class="sc">%&gt;%</span> <span class="co"># Grupper efter flere variable... </span></span>
<span id="cb321-3"><a href="data2.html#cb321-3" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups=</span><span class="st">&quot;keep&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 10 × 3
#&gt; # Groups:   Embarked, Pclass [10]
#&gt;    Embarked Pclass count
#&gt;    &lt;chr&gt;     &lt;int&gt; &lt;int&gt;
#&gt;  1 &quot;&quot;            1     2
#&gt;  2 &quot;C&quot;           1    74
#&gt;  3 &quot;C&quot;           2    15
#&gt;  4 &quot;C&quot;           3    41
#&gt;  5 &quot;Q&quot;           1     2
#&gt;  6 &quot;Q&quot;           2     2
#&gt;  7 &quot;Q&quot;           3    24
#&gt;  8 &quot;S&quot;           1   108
#&gt;  9 &quot;S&quot;           2   156
#&gt; 10 &quot;S&quot;           3   290</code></pre>
<p>Man kan se, at størstedelen gik ombord i Southampton (S), men der var også forholdsvis mange førsteklasses-passagerer, der gik ombord i Cherbourg (C). Lad os fortsætte med vores <code>Survived</code>-eksempel og beregne proportionen af overlevende efter de tre variabler <code>Adult</code>, <code>Sex</code> og <code>Pclass</code>.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="data2.html#cb323-1" tabindex="-1"></a>titanic_clean_summary_survived <span class="ot">&lt;-</span> titanic_clean <span class="sc">%&gt;%</span>  </span>
<span id="cb323-2"><a href="data2.html#cb323-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Adult =</span> <span class="fu">ifelse</span>(Age<span class="sc">&gt;=</span><span class="dv">18</span>,<span class="st">&quot;Adult&quot;</span>,<span class="st">&quot;Child&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb323-3"><a href="data2.html#cb323-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Adult,Sex,Pclass) <span class="sc">%&gt;%</span> </span>
<span id="cb323-4"><a href="data2.html#cb323-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanSurvived =</span> <span class="fu">mean</span>(Survived), <span class="at">.groups=</span><span class="st">&quot;keep&quot;</span>)</span>
<span id="cb323-5"><a href="data2.html#cb323-5" tabindex="-1"></a>titanic_clean_summary_survived</span></code></pre></div>
<pre><code>#&gt; # A tibble: 12 × 4
#&gt; # Groups:   Adult, Sex, Pclass [12]
#&gt;    Adult Sex    Pclass meanSurvived
#&gt;    &lt;chr&gt; &lt;chr&gt;   &lt;int&gt;        &lt;dbl&gt;
#&gt;  1 Adult female      1       0.974 
#&gt;  2 Adult female      2       0.903 
#&gt;  3 Adult female      3       0.418 
#&gt;  4 Adult male        1       0.371 
#&gt;  5 Adult male        2       0.0682
#&gt;  6 Adult male        3       0.133 
#&gt;  7 Child female      1       0.875 
#&gt;  8 Child female      2       1     
#&gt;  9 Child female      3       0.543 
#&gt; 10 Child male        1       1     
#&gt; 11 Child male        2       0.818 
#&gt; 12 Child male        3       0.233</code></pre>
<p>Vi kan også visualisere resultatet i en <code>ggplot</code> med at kombinere de tre variabler og opdeler de i tre plots efter <code>Pclass</code>:</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="data2.html#cb325-1" tabindex="-1"></a><span class="fu">ggplot</span>(titanic_clean_summary_survived,<span class="fu">aes</span>(<span class="at">x=</span>Sex,<span class="at">y=</span>meanSurvived,<span class="at">fill=</span>Adult)) <span class="sc">+</span></span>
<span id="cb325-2"><a href="data2.html#cb325-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> </span>
<span id="cb325-3"><a href="data2.html#cb325-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>Pclass) <span class="sc">+</span> </span>
<span id="cb325-4"><a href="data2.html#cb325-4" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Proportion survived&quot;</span>) <span class="sc">+</span></span>
<span id="cb325-5"><a href="data2.html#cb325-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="06-tidyverse2_files/figure-html/unnamed-chunk-16-1.svg" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="funktionen-ungroup" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Funktionen <code>ungroup()</code><a href="data2.html#funktionen-ungroup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nogle gange, når man er færdig med analysen, men gerne vil arbejde videre med et datasæt, er det nyttigt at anvende <code>ungroup()</code> på datasættet igen. Det er mest relevant i længere projekter. F.eks., vi kan se på følgende kode, hvor der står “Groups: Adult [2]” øverst i den nye dataframe med summeringsstatistikker:</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="data2.html#cb326-1" tabindex="-1"></a>titanic_clean_summary <span class="ot">&lt;-</span> titanic_clean <span class="sc">%&gt;%</span>  </span>
<span id="cb326-2"><a href="data2.html#cb326-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Adult =</span> <span class="fu">ifelse</span>(Age<span class="sc">&gt;=</span><span class="dv">18</span>,<span class="st">&quot;Adult&quot;</span>,<span class="st">&quot;Child&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb326-3"><a href="data2.html#cb326-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Adult,Sex) <span class="sc">%&gt;%</span> </span>
<span id="cb326-4"><a href="data2.html#cb326-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanSurvived =</span> <span class="fu">mean</span>(Survived), <span class="at">.groups =</span> <span class="st">&quot;drop_last&quot;</span>)</span>
<span id="cb326-5"><a href="data2.html#cb326-5" tabindex="-1"></a></span>
<span id="cb326-6"><a href="data2.html#cb326-6" tabindex="-1"></a>titanic_clean_summary</span></code></pre></div>
<pre><code>#&gt; # A tibble: 4 × 3
#&gt; # Groups:   Adult [2]
#&gt;   Adult Sex    meanSurvived
#&gt;   &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;
#&gt; 1 Adult female        0.772
#&gt; 2 Adult male          0.177
#&gt; 3 Child female        0.691
#&gt; 4 Child male          0.397</code></pre>
<p>Bemærk at vi først brugte <code>group_by()</code> på både <code>Adult</code> og <code>Sex</code>. Men hver gang man laver en beregning, fjernes én opdeling - i dette tilfælde opdeles der ikke længere efter <code>Sex</code>, men der opdeles stadig efter <code>Adult</code>. Det er ikke et problem, hvis vi ikke vil arbejde videre med dataframen. Men hvis vi gerne vil beregne den maksimale chance for overlevelse ud fra de fire beregnede tal (ikke opdele efter en kategorisk variabel), så dropper vi <code>group_by()</code>:</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="data2.html#cb328-1" tabindex="-1"></a>titanic_clean_summary <span class="sc">%&gt;%</span> </span>
<span id="cb328-2"><a href="data2.html#cb328-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">maxChance =</span> <span class="fu">max</span>(meanSurvived))</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 × 2
#&gt;   Adult maxChance
#&gt;   &lt;chr&gt;     &lt;dbl&gt;
#&gt; 1 Adult     0.772
#&gt; 2 Child     0.691</code></pre>
<p>Man kan dog se, at outputtet er blevet opdelt efter variablen <code>Adult</code>. For at undgå dette skal man først anvende <code>ungroup()</code>, så effekten af <code>group_by()</code> fjernes.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="data2.html#cb330-1" tabindex="-1"></a>titanic_clean_summary <span class="sc">%&gt;%</span> </span>
<span id="cb330-2"><a href="data2.html#cb330-2" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb330-3"><a href="data2.html#cb330-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;maxChance&quot;</span> <span class="ot">=</span> <span class="fu">max</span>(meanSurvived))</span></code></pre></div>
<pre><code>#&gt; # A tibble: 1 × 1
#&gt;   maxChance
#&gt;       &lt;dbl&gt;
#&gt; 1     0.772</code></pre>
</div>
</div>
<div id="pivot_longerpivot_wider-fra-tidyr-pakken" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> <code>pivot_longer()</code>/<code>pivot_wider()</code> fra <code>tidyr</code>-pakken<a href="data2.html#pivot_longerpivot_wider-fra-tidyr-pakken" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Tidy data</strong> findes i to former: wide data og long data. Det kan være nyttigt at transformere data fra én form til en anden, f.eks. for at lave et bestemt plot med <code>ggplot2</code>-pakken. Pakken <code>tidyr</code> indeholder funktioner, der kan bruges til at lave disse transformationer.</p>
<p>Før vi begynder at se lidt nærmere på <code>tidyr</code>, skal vi beskrive hvad <code>long</code> data og <code>wide</code> data betyder.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-20"></span>
<img src="plots/original-dfs-tidy.png" alt="source: https://www.garrickadenbuie.com/project/tidyexplain/" width="75%" />
<p class="caption">
Figure 6.1: source: <a href="https://www.garrickadenbuie.com/project/tidyexplain/" class="uri">https://www.garrickadenbuie.com/project/tidyexplain/</a>
</p>
</div>
<p><strong>Wide data</strong>: Her har man én kolonne for hver variabel og én række for hver observation. Dette gør dataene lette at forstå, og denne datatype findes ofte indenfor biologi - f.eks. hvis man har forskellige prøver (behandlinger, kontroller, betingelser osv.) som variabler.</p>
<p><strong>Long data</strong>: Med long data har man værdier samlet i en enkelt kolonne og en kolonne som en slags nøgle, der også angiver, hvilken variabel hver værdi hørte til i det wide format. Datasættet betragtes stadig som <strong>tidy</strong>, men informationen opbevares på en anden måde. Det er lidt sværere at læse, men nemmere at arbejde med, når man analyserer dataene.</p>
<p>Når man transformerer data fra wide til long eller omvendt, kaldes det for <strong>reshaping</strong>.</p>
<div id="oversigt-over-tidyr-pakken" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Oversigt over <code>tidyr</code> pakken<a href="data2.html#oversigt-over-tidyr-pakken" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Her er en oversigt over de fire vigtigste funktioner fra R-pakken <code>tidyr</code>. Vi fokuserer mest på <code>pivot</code>-funktionerne, men det kan være nyttigt at bruge <code>separate</code> og <code>unite</code>.</p>
<table>
<thead>
<tr class="header">
<th><code>tidyr</code> funktion</th>
<th>Beskrivelse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pivot_longer()</code></td>
<td>reshape data fra wide til long</td>
</tr>
<tr class="even">
<td><code>pivot_wider()</code></td>
<td>reshape data fra long til wide</td>
</tr>
<tr class="odd">
<td><code>separate()</code></td>
<td>opdele strenge fra én kolonne til to</td>
</tr>
<tr class="even">
<td><code>unite()</code></td>
<td>føje strenge sammen fra to til én kolonne</td>
</tr>
</tbody>
</table>
</div>
<div id="reshape-data-fra-wide-til-long-med-pivot_longer" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Reshape data fra wide til long med <code>pivot_longer()</code><a href="data2.html#reshape-data-fra-wide-til-long-med-pivot_longer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lad os arbejde med datasættet <code>iris</code>. Man får <code>iris</code> i long format med følgende kommando: Her vil man gerne tage alle numeriske kolonner og placere deres værdier i en enkelt kolonne <code>value</code> (med en nøglekolonne <code>name</code> til at adskille mellem de forskellige variabler).</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="data2.html#cb332-1" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb332-2"><a href="data2.html#cb332-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">where</span>(is.numeric))</span></code></pre></div>
<pre><code>#&gt; # A tibble: 600 × 3
#&gt;    Species name         value
#&gt;    &lt;fct&gt;   &lt;chr&gt;        &lt;dbl&gt;
#&gt;  1 setosa  Sepal.Length   5.1
#&gt;  2 setosa  Sepal.Width    3.5
#&gt;  3 setosa  Petal.Length   1.4
#&gt;  4 setosa  Petal.Width    0.2
#&gt;  5 setosa  Sepal.Length   4.9
#&gt;  6 setosa  Sepal.Width    3  
#&gt;  7 setosa  Petal.Length   1.4
#&gt;  8 setosa  Petal.Width    0.2
#&gt;  9 setosa  Sepal.Length   4.7
#&gt; 10 setosa  Sepal.Width    3.2
#&gt; # ℹ 590 more rows</code></pre>
<p>At beholde numeriske kolonner svarer i dette tilfælde til at man ikke vil have variablen <code>Species</code> med i den enkelte kolonne:</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="data2.html#cb334-1" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb334-2"><a href="data2.html#cb334-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Species)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 600 × 3
#&gt;    Species name         value
#&gt;    &lt;fct&gt;   &lt;chr&gt;        &lt;dbl&gt;
#&gt;  1 setosa  Sepal.Length   5.1
#&gt;  2 setosa  Sepal.Width    3.5
#&gt;  3 setosa  Petal.Length   1.4
#&gt;  4 setosa  Petal.Width    0.2
#&gt;  5 setosa  Sepal.Length   4.9
#&gt;  6 setosa  Sepal.Width    3  
#&gt;  7 setosa  Petal.Length   1.4
#&gt;  8 setosa  Petal.Width    0.2
#&gt;  9 setosa  Sepal.Length   4.7
#&gt; 10 setosa  Sepal.Width    3.2
#&gt; # ℹ 590 more rows</code></pre>
<p>Her er et billede, der illustrerer wide- og long-formatet med datasættet <code>iris</code>:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-23"></span>
<img src="plots/wide_to_long.png" alt="wide til long med Iris" width="100%" />
<p class="caption">
Figure 6.2: wide til long med Iris
</p>
</div>
<p>Til venstre har vi målingerne i datasættet fordelt over fire forskellige kolonner kaldet <code>Sepal.Length</code>, <code>Sepal.Width</code>, <code>Petal.Length</code> og <code>Petal.Width</code>, samt en ekstra kolonne, der adksiller mellem de tre <code>Species</code>. Til højre har vi samlet alle målingerne i en enkelt kolonne kaldet <code>values</code>, og så bruger vi en anden ‘nøgle’ kolonne kaldet <code>name</code> til at fortælle om det er en måling for <code>Sepal.Length</code> eller <code>Sepal.Width</code> osv.</p>
<p>Jeg kan ændre kolonnenavne for målingerne og nøglen til noget andet end standardnavnene. I den nedenstående eksempel skal målingerne hedde <code>measurements</code> og nøglen <code>trait</code>:</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="data2.html#cb336-1" tabindex="-1"></a>iris.long <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Species,</span>
<span id="cb336-2"><a href="data2.html#cb336-2" tabindex="-1"></a>                                    <span class="at">names_to =</span> <span class="st">&quot;trait&quot;</span>,</span>
<span id="cb336-3"><a href="data2.html#cb336-3" tabindex="-1"></a>                                    <span class="at">values_to =</span> <span class="st">&quot;measurement&quot;</span>)</span></code></pre></div>
<p><img src="plots/wide_to_long_names.png" width="100%" style="display: block; margin: auto;" /></p>
<p>F.eks. kan man bruge long formatet til at visualisere alle mulige boxplots opdelt efter <code>Species</code> og <code>trait</code> i samme plot:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="data2.html#cb337-1" tabindex="-1"></a><span class="fu">ggplot</span>(iris.long,<span class="fu">aes</span>(<span class="at">y=</span>measurement,<span class="at">x=</span>Species,<span class="at">fill=</span>Species)) <span class="sc">+</span> </span>
<span id="cb337-2"><a href="data2.html#cb337-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb337-3"><a href="data2.html#cb337-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>trait) <span class="sc">+</span></span>
<span id="cb337-4"><a href="data2.html#cb337-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="06-tidyverse2_files/figure-html/unnamed-chunk-26-1.svg" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="separate" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> <code>separate()</code><a href="data2.html#separate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Funktionen <code>separate()</code> fra pakken <code>tidyr</code> kan bruges til at opdele to informationer, som eksisterer i samme kolonne. F.eks., datasættet <code>iris</code> har variabler med navne <code>Sepal.Width</code>, <code>Sepal.Length</code> osv. - man kan opdele disse navne over to kolonner i stedet for - f.eks. “Sepal” og “Width” i tilfældet af <code>Sepal.Width</code>. I nedenstående kode chunk kan man se, hvordan man bruger <code>separate()</code>.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="data2.html#cb338-1" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb338-2"><a href="data2.html#cb338-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Species, <span class="at">names_to =</span> <span class="st">&quot;trait&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;measurement&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb338-3"><a href="data2.html#cb338-3" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> trait, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;part&quot;</span>, <span class="st">&quot;measure&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb338-4"><a href="data2.html#cb338-4" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>#&gt; # A tibble: 6 × 4
#&gt;   Species part  measure measurement
#&gt;   &lt;fct&gt;   &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;
#&gt; 1 setosa  Sepal Length          5.1
#&gt; 2 setosa  Sepal Width           3.5
#&gt; 3 setosa  Petal Length          1.4
#&gt; 4 setosa  Petal Width           0.2
#&gt; 5 setosa  Sepal Length          4.9
#&gt; 6 setosa  Sepal Width           3</code></pre>
<p>Man specificerer variablen <code>trait</code> og angiver, at den skal opdeles i de to variabler <code>part</code> og <code>measure</code>. Vi angiver <code>sep = "\\."</code>, hvilket betyder, at vi vil gerne have <code>part</code> som delen af <code>trait</code> foran ‘.’ og <code>measure</code> som delen af <code>trait</code> efter <code>.</code>. Vi bruger “\.” for at fortælle, at vi er interesseret i punktummet og ikke en “anonym karakter”, som punktum normalt betyder i “streng”-sprog. Man behøver faktisk ikke at specificere <code>sep = "\\."</code> i dette tilfælde - som standard kigger funktionen efter ‘non-character’ tegn og bruger dem til at lave opdelingen.</p>
<p>Sammenligne resultatet af den sidste kode chunk med den følgende:</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="data2.html#cb340-1" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb340-2"><a href="data2.html#cb340-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Species, <span class="at">names_to =</span> <span class="st">&quot;trait&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;measurement&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb340-3"><a href="data2.html#cb340-3" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> trait, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;part&quot;</span>, <span class="st">&quot;measure&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb340-4"><a href="data2.html#cb340-4" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>#&gt; # A tibble: 6 × 4
#&gt;   Species part  measure measurement
#&gt;   &lt;fct&gt;   &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;
#&gt; 1 setosa  Sepal Length          5.1
#&gt; 2 setosa  Sepal Width           3.5
#&gt; 3 setosa  Petal Length          1.4
#&gt; 4 setosa  Petal Width           0.2
#&gt; 5 setosa  Sepal Length          4.9
#&gt; 6 setosa  Sepal Width           3</code></pre>
<p>Brug resultatet i et plot:</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="data2.html#cb342-1" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb342-2"><a href="data2.html#cb342-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Species, <span class="at">names_to =</span> <span class="st">&quot;trait&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;measurement&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb342-3"><a href="data2.html#cb342-3" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> trait, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;part&quot;</span>, <span class="st">&quot;measure&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb342-4"><a href="data2.html#cb342-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>measurement,<span class="at">x=</span>part,<span class="at">fill=</span>part)) <span class="sc">+</span> </span>
<span id="cb342-5"><a href="data2.html#cb342-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb342-6"><a href="data2.html#cb342-6" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>measure) <span class="sc">+</span></span>
<span id="cb342-7"><a href="data2.html#cb342-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="06-tidyverse2_files/figure-html/unnamed-chunk-29-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p>Se også <code>unite()</code> som gøre det modsatte til <code>separate()</code>.</p>
</div>
</div>
<div id="eksempel-titanic-opsummeringsstatistikker" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Eksempel: Titanic opsummeringsstatistikker<a href="data2.html#eksempel-titanic-opsummeringsstatistikker" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Her er et eksempel med datasættet <code>titanic</code>, der inddrager mange af de <code>tidyverse</code>-koncepter, vi har lært indtil videre.</p>
<ul>
<li><code>group_by()</code> og <code>summarise()</code></li>
</ul>
<p>Vi producerer vores opsummeringsstatistikker som tidliger.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="data2.html#cb343-1" tabindex="-1"></a>titanic_clean_summary_by_sex <span class="ot">&lt;-</span> titanic_clean <span class="sc">%&gt;%</span></span>
<span id="cb343-2"><a href="data2.html#cb343-2" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex) <span class="sc">%&gt;%</span></span>
<span id="cb343-3"><a href="data2.html#cb343-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb343-4"><a href="data2.html#cb343-4" tabindex="-1"></a>            <span class="at">meanSurvived =</span> <span class="fu">mean</span>(Survived),</span>
<span id="cb343-5"><a href="data2.html#cb343-5" tabindex="-1"></a>            <span class="at">meanAge =</span> <span class="fu">mean</span>(Age),</span>
<span id="cb343-6"><a href="data2.html#cb343-6" tabindex="-1"></a>            <span class="at">propFirst =</span> <span class="fu">sum</span>(Pclass <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">n</span>())</span>
<span id="cb343-7"><a href="data2.html#cb343-7" tabindex="-1"></a>titanic_clean_summary_by_sex</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 × 5
#&gt;   Sex    count meanSurvived meanAge propFirst
#&gt;   &lt;chr&gt;  &lt;int&gt;        &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
#&gt; 1 female   261        0.755    27.9     0.326
#&gt; 2 male     453        0.205    30.7     0.223</code></pre>
<ul>
<li><code>pivot_longer()</code></li>
</ul>
<p>Vi transformerer eller <strong>reshape</strong> dataframen fra wide data til long data. Vi vil samle kun de numeriske opsummeringsstatistikker i en enkelt kolonne, så variablen <code>Sex</code> skal ikke inddrages.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="data2.html#cb345-1" tabindex="-1"></a>titanic_clean_summary_by_sex <span class="sc">%&gt;%</span></span>
<span id="cb345-2"><a href="data2.html#cb345-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>Sex)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 8 × 3
#&gt;   Sex    name           value
#&gt;   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;
#&gt; 1 female count        261    
#&gt; 2 female meanSurvived   0.755
#&gt; 3 female meanAge       27.9  
#&gt; 4 female propFirst      0.326
#&gt; 5 male   count        453    
#&gt; 6 male   meanSurvived   0.205
#&gt; 7 male   meanAge       30.7  
#&gt; 8 male   propFirst      0.223</code></pre>
<ul>
<li><code>ggplot()</code> med <code>facet_wrap()</code></li>
</ul>
<p>Vi kombinerer <code>pivot_longer()</code> med et plot af vores opsummeringsstatistikker og benytter <code>facet_grid()</code> til at adskille de forskellige statistikker.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="data2.html#cb347-1" tabindex="-1"></a>titanic_clean_summary_by_sex <span class="sc">%&gt;%</span> </span>
<span id="cb347-2"><a href="data2.html#cb347-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Sex) <span class="sc">%&gt;%</span></span>
<span id="cb347-3"><a href="data2.html#cb347-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> value, <span class="at">fill =</span> Sex)) <span class="sc">+</span> </span>
<span id="cb347-4"><a href="data2.html#cb347-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb347-5"><a href="data2.html#cb347-5" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>name) <span class="sc">+</span></span>
<span id="cb347-6"><a href="data2.html#cb347-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb347-7"><a href="data2.html#cb347-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="06-tidyverse2_files/figure-html/unnamed-chunk-32-1.svg" width="672" style="display: block; margin: auto;" /></p>
<ul>
<li><code>facet_wrap()</code></li>
</ul>
<p>Vi laver det samme som før, men specificerer <code>facet_wrap()</code> i stedet for <code>facet_grid()</code>. Indenfor <code>facet_wrap()</code> kan man bruge indstillingen <code>scales="free"</code>, som gør, at de fire plots får hver deres egne aksegrænser.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="data2.html#cb348-1" tabindex="-1"></a>titanic_clean_summary_by_sex <span class="sc">%&gt;%</span> </span>
<span id="cb348-2"><a href="data2.html#cb348-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>Sex) <span class="sc">%&gt;%</span></span>
<span id="cb348-3"><a href="data2.html#cb348-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sex,<span class="at">y=</span>value,<span class="at">fill=</span>Sex)) <span class="sc">+</span> </span>
<span id="cb348-4"><a href="data2.html#cb348-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb348-5"><a href="data2.html#cb348-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name,<span class="at">scales=</span><span class="st">&quot;free&quot;</span>,<span class="at">ncol=</span><span class="dv">4</span>) <span class="sc">+</span>  </span>
<span id="cb348-6"><a href="data2.html#cb348-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb348-7"><a href="data2.html#cb348-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="06-tidyverse2_files/figure-html/unnamed-chunk-33-1.svg" width="672" style="display: block; margin: auto;" /></p>
<div id="pivot_wider" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> <code>pivot_wider()</code><a href="data2.html#pivot_wider" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hvordån skifter man fra long til wide formatet?</p>
<ul>
<li>Wide -&gt; Long</li>
</ul>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="data2.html#cb349-1" tabindex="-1"></a>titanic_summary_long <span class="ot">&lt;-</span> titanic_clean_summary_by_sex <span class="sc">%&gt;%</span> </span>
<span id="cb349-2"><a href="data2.html#cb349-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>Sex)</span></code></pre></div>
<ul>
<li>Long -&gt; Wide</li>
</ul>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="data2.html#cb350-1" tabindex="-1"></a>titanic_summary_long <span class="sc">%&gt;%</span></span>
<span id="cb350-2"><a href="data2.html#cb350-2" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span>,<span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 2 × 5
#&gt;   Sex    count meanSurvived meanAge propFirst
#&gt;   &lt;chr&gt;  &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
#&gt; 1 female   261        0.755    27.9     0.326
#&gt; 2 male     453        0.205    30.7     0.223</code></pre>
<p>Parametrene er:</p>
<ul>
<li><code>names_from</code> - nøglekolonne, som vil blive opdelt i flere kolonner i den nye dataframe</li>
<li><code>values_from</code> - værdikolonne, som vil blive fordelt på tværs af de nye kolonner</li>
</ul>
</div>
</div>
<div id="left_join-forbinde-dataframes" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> <code>left_join()</code>: forbinde dataframes<a href="data2.html#left_join-forbinde-dataframes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vi tager udgangspunkt i følgende to dataframes:</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="data2.html#cb352-1" tabindex="-1"></a>gene_table <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read.table</span>(<span class="st">&quot;https://www.dropbox.com/s/6ll8ezrskly8joi/mouse_2gene_expr.txt?dl=1&quot;</span>,<span class="at">header=</span>T))</span>
<span id="cb352-2"><a href="data2.html#cb352-2" tabindex="-1"></a>coldata <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read.table</span>(<span class="st">&quot;https://www.dropbox.com/s/jlrszakmqlnmu2m/bottomly_phenodata.txt?dl=1&quot;</span>))</span></code></pre></div>
<p>Lad os først kigge på datasættet <code>gene_table</code>, som viser genekspressionsmålinger over forskellige prøver fra mus.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="data2.html#cb353-1" tabindex="-1"></a>gene_table</span></code></pre></div>
<pre><code>#&gt; # A tibble: 3 × 22
#&gt;   gene     SRX033480 SRX033488 SRX033481 SRX033489 SRX033482 SRX033490 SRX033483
#&gt;   &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
#&gt; 1 ENSMUSG…      158.      182.     119.       155.     167.      164.       180.
#&gt; 2 ENSMUSG…      143.      118.      91.6      106.     157.       95.1      131.
#&gt; 3 ENSMUSG…      132.      117.     100.       116.      88.1     125.       124.
#&gt; # ℹ 14 more variables: SRX033476 &lt;dbl&gt;, SRX033478 &lt;dbl&gt;, SRX033479 &lt;dbl&gt;,
#&gt; #   SRX033472 &lt;dbl&gt;, SRX033473 &lt;dbl&gt;, SRX033474 &lt;dbl&gt;, SRX033475 &lt;dbl&gt;,
#&gt; #   SRX033491 &lt;dbl&gt;, SRX033484 &lt;dbl&gt;, SRX033492 &lt;dbl&gt;, SRX033485 &lt;dbl&gt;,
#&gt; #   SRX033493 &lt;dbl&gt;, SRX033486 &lt;dbl&gt;, SRX033494 &lt;dbl&gt;</code></pre>
<p>Man kan se, at der er 22 kolonner i datasættet - én der refererer til gener og 21 som indikerer forskellige prøver fra eksperimentet. Men det er ikke klart, hvad den enkelte prøve egentlig er. Lad os derfor kigge på de prøveoplysninger, som kan være nyttige at inddrage i vores analyse/plots for at undersøge eventuelle batcheffekter osv.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="data2.html#cb355-1" tabindex="-1"></a>coldata</span></code></pre></div>
<pre><code>#&gt; # A tibble: 21 × 5
#&gt;    sample    num.tech.reps strain   batch lane.number
#&gt;    &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;    &lt;int&gt;       &lt;int&gt;
#&gt;  1 SRX033480             1 C57BL.6J     6           1
#&gt;  2 SRX033488             1 C57BL.6J     7           1
#&gt;  3 SRX033481             1 C57BL.6J     6           2
#&gt;  4 SRX033489             1 C57BL.6J     7           2
#&gt;  5 SRX033482             1 C57BL.6J     6           3
#&gt;  6 SRX033490             1 C57BL.6J     7           3
#&gt;  7 SRX033483             1 C57BL.6J     6           5
#&gt;  8 SRX033476             1 C57BL.6J     4           6
#&gt;  9 SRX033478             1 C57BL.6J     4           7
#&gt; 10 SRX033479             1 C57BL.6J     4           8
#&gt; # ℹ 11 more rows</code></pre>
<p>Man kan se detaljerede oplysninger om de 21 prøver, blandt andet den stamme af mus prøven stammer fra og dens batch. Her refererer <code>batch</code> til de forskellige omstændigheder eller tidspunkter, hvor prøverne blev samlet. Hvis man er interesseret i, om der er en forskel i ekspressionsniveau mellem de to stammer (strains), kan det være nødvendigt at kontrollere efter batch for at sikre, at forskellen skyldes <code>strain</code> og ikke tekniske effekter på grund af <code>batch</code>.</p>
<div id="left_join-fra-dplyr-pakken" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> <code>left_join()</code> fra dplyr-pakken<a href="data2.html#left_join-fra-dplyr-pakken" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Funktionen <code>left_join()</code> er en del af pakken <code>dplyr</code>, som vi har arbejdet meget med indtil videre i kurset.</p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>funktion</th>
<th>Beskrivelse (kopieret)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>left_join()</code></td>
<td>Tilføj matchende rækker fra en anden tabel til den første</td>
</tr>
<tr class="even">
<td><code>right_join()</code></td>
<td>Tilføj matchende rækker fra den første tabel til den anden</td>
</tr>
<tr class="odd">
<td><code>inner_join()</code></td>
<td>Sammenføj to tabeller og returner alle rækker, der er til stede i begge</td>
</tr>
<tr class="even">
<td><code>full_join()</code></td>
<td>Sammenføj data med alle rækker til stede</td>
</tr>
</tbody>
</table>
<p>Vi fokuserer her på funktionen <code>left_join()</code>, men vi kigger også på de øvrige funktioner i problemstillingerne nedenfor. Her er en grafisk demonstration af <code>left_join()</code> (kilde: <a href="https://mgimond.github.io/ES218/Week03c.html" class="uri">https://mgimond.github.io/ES218/Week03c.html</a>):</p>
<p><img src="plots/left_join.png" width="60%" style="display: block; margin: auto;" /></p>
<p>Det særlige ved <code>left_join</code> i forhold til de andre funktioner er, at <code>left_join</code> bevarer samtlige data i den første dataframe - det vil sige <code>df</code> i ovenstående billede. Det gælder også selvom <code>d</code> ikke matcher med en frugt i <code>dj</code>. I ovenstående genekspressionseksempel betyder det, at man bevarer alle målinger i <code>gene_table</code>, uanset om der er oplysninger om deres pågældende prøver.</p>
</div>
<div id="anvend-left_join-på-vores-datasæt." class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Anvend <code>left_join()</code> på vores datasæt.<a href="data2.html#anvend-left_join-på-vores-datasæt." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ligesom man matcher kolonnen <code>y</code> i <code>df</code> og <code>dj</code> i ovenstående eksempel, skal vi også have en kolonne, vi kan matche. Vi vil gerne bruge kolonnen <code>sample</code> fra <code>sample_info</code> til at sammenligne med de forskellige prøvenavne i <code>gene_table</code>. Men først er vi nødt til at lave <code>gene_table</code> om til long-formatet, således at prøvenavne fremgår i en enkelt kolonne, <code>sample</code> (der kan bruges i <code>left_join</code>).</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="data2.html#cb357-1" tabindex="-1"></a>gene_table_long <span class="ot">&lt;-</span> gene_table <span class="sc">%&gt;%</span> </span>
<span id="cb357-2"><a href="data2.html#cb357-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>gene,</span>
<span id="cb357-3"><a href="data2.html#cb357-3" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;sample&quot;</span>,</span>
<span id="cb357-4"><a href="data2.html#cb357-4" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;expression&quot;</span>) </span>
<span id="cb357-5"><a href="data2.html#cb357-5" tabindex="-1"></a>gene_table_long</span></code></pre></div>
<pre><code>#&gt; # A tibble: 63 × 3
#&gt;    gene               sample    expression
#&gt;    &lt;chr&gt;              &lt;chr&gt;          &lt;dbl&gt;
#&gt;  1 ENSMUSG00000006517 SRX033480       158.
#&gt;  2 ENSMUSG00000006517 SRX033488       182.
#&gt;  3 ENSMUSG00000006517 SRX033481       119.
#&gt;  4 ENSMUSG00000006517 SRX033489       155.
#&gt;  5 ENSMUSG00000006517 SRX033482       167.
#&gt;  6 ENSMUSG00000006517 SRX033490       164.
#&gt;  7 ENSMUSG00000006517 SRX033483       180.
#&gt;  8 ENSMUSG00000006517 SRX033476       263.
#&gt;  9 ENSMUSG00000006517 SRX033478       276.
#&gt; 10 ENSMUSG00000006517 SRX033479       328.
#&gt; # ℹ 53 more rows</code></pre>
<p>Derefter kan vi tilføje oplysningsdata fra <code>sample_info</code>. Her angiver vi <code>by = "sample"</code> fordi det er navnet af kolonnen vi vil gerne bruge til at forbinde de to dataframes og fordi det er med i begge dataframes.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="data2.html#cb359-1" tabindex="-1"></a>data_join <span class="ot">&lt;-</span> gene_table_long  <span class="sc">%&gt;%</span></span>
<span id="cb359-2"><a href="data2.html#cb359-2" tabindex="-1"></a>  <span class="fu">left_join</span>(coldata, <span class="at">by=</span><span class="st">&quot;sample&quot;</span>)</span></code></pre></div>
<p>Efter vi forenede de to dataframes, kan man inddrage de ekstra oplysninger vi tilføjede i et plot. Her laver vi et plot med en farve til hver stamme og et plot med en farve til hver batch.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="data2.html#cb360-1" tabindex="-1"></a>gg2 <span class="ot">&lt;-</span> data_join <span class="sc">%&gt;%</span> </span>
<span id="cb360-2"><a href="data2.html#cb360-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>expression,<span class="at">x=</span><span class="fu">as.factor</span>(strain),<span class="at">fill=</span>gene)) <span class="sc">+</span> </span>
<span id="cb360-3"><a href="data2.html#cb360-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb360-4"><a href="data2.html#cb360-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>gene,<span class="at">scales=</span><span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb360-5"><a href="data2.html#cb360-5" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb360-6"><a href="data2.html#cb360-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb360-7"><a href="data2.html#cb360-7" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Expression split according to strain&quot;</span>)</span>
<span id="cb360-8"><a href="data2.html#cb360-8" tabindex="-1"></a>gg2</span></code></pre></div>
<p><img src="06-tidyverse2_files/figure-html/unnamed-chunk-42-1.svg" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="data2.html#cb361-1" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> data_join <span class="sc">%&gt;%</span> </span>
<span id="cb361-2"><a href="data2.html#cb361-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>expression,<span class="at">x=</span><span class="fu">as.factor</span>(batch),<span class="at">fill=</span>gene)) <span class="sc">+</span> </span>
<span id="cb361-3"><a href="data2.html#cb361-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb361-4"><a href="data2.html#cb361-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>gene,<span class="at">scales=</span><span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb361-5"><a href="data2.html#cb361-5" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb361-6"><a href="data2.html#cb361-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb361-7"><a href="data2.html#cb361-7" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Expression split according to batch&quot;</span>)</span>
<span id="cb361-8"><a href="data2.html#cb361-8" tabindex="-1"></a></span>
<span id="cb361-9"><a href="data2.html#cb361-9" tabindex="-1"></a>gg1</span></code></pre></div>
<p><img src="06-tidyverse2_files/figure-html/unnamed-chunk-43-1.svg" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="problemstillinger-5" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Problemstillinger<a href="data2.html#problemstillinger-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Problem 1</strong>) Lav quizzen - “Quiz - tidyverse dag 2”.</p>
<hr />
<p><em>Vi øver os videre med datasættet <code>titanic</code>. Indlæs datasættet og udfør oprydning med følgende kode:</em></p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="data2.html#cb362-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb362-2"><a href="data2.html#cb362-2" tabindex="-1"></a><span class="fu">library</span>(titanic)</span>
<span id="cb362-3"><a href="data2.html#cb362-3" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(titanic_train)</span>
<span id="cb362-4"><a href="data2.html#cb362-4" tabindex="-1"></a></span>
<span id="cb362-5"><a href="data2.html#cb362-5" tabindex="-1"></a>titanic_clean <span class="ot">&lt;-</span> titanic <span class="sc">%&gt;%</span></span>
<span id="cb362-6"><a href="data2.html#cb362-6" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Cabin) <span class="sc">%&gt;%</span></span>
<span id="cb362-7"><a href="data2.html#cb362-7" tabindex="-1"></a>    <span class="fu">drop_na</span>()</span></code></pre></div>
<hr />
<p><strong>Problem 2</strong>)</p>
<p>Baseret på <code>titanic_clean</code> datasættet, beregn den gennemsnitlige alder af alle passagerer ombord på skibet.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="data2.html#cb363-1" tabindex="-1"></a>titanic_clean <span class="sc">%&gt;%</span></span>
<span id="cb363-2"><a href="data2.html#cb363-2" tabindex="-1"></a>    <span class="fu">summarise</span>(....) <span class="co">#rediger her</span></span></code></pre></div>
<ul>
<li>I samme kommando, beregn også den maksimale alder og den minimale alder, samt proportionen af passagerer, der er under 18 (for den sidste, se eksempeln med <code>Pclass</code> tidligere i sektion <strong>6.2.2</strong>). Dataframen skal se sådan ud:</li>
</ul>
<pre><code>#&gt; # A tibble: 1 × 4
#&gt;   mean_alder max_alder min_alder under_18p
#&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
#&gt; 1       29.7        80      0.42     0.158</code></pre>
<hr />
<p><strong>Problem 3</strong>)</p>
<p><strong>a)</strong> Beregn samme opsummeringsstatistikker som i sidste problemstilling, men brug <code>group_by()</code> for at opdele efter variablen <code>Pclass</code>.</p>
<p><strong>b)</strong> Brug din nye dataframe med opsummeringsstatistikker til at lave et søjlediagram med <code>stat="identity"</code> (i stedet for <code>stat="count"</code> som er standarden), der viser den gennemsnitlige alder på y-aksen og er opdelt efter <code>Pclass</code> på x-aksen (vær opmærksom på datatypen for <code>Pclass</code> med hensyn til farverne/x-aksen).</p>
<p><strong>c)</strong> Anvend <code>pivot_longer()</code> på din dataframe med opsummeringsstatistikker (brug indstillingen <code>cols = -Pclass</code> i funktionen).</p>
<p><strong>d)</strong> Brug din long-format dataframe med opsummeringsstatistikker til at lave plots af alle opsummeringsstatistikker med én <code>ggplot</code> kommando (adskil dem ved at benytte <code>facet_wrap</code> så du har et plot til hvert opsummeringsstatistik og opdele efter <code>Pclass</code> indenfor hvert plot, ligesom i følgende).</p>
<p><img src="06-tidyverse2_files/figure-html/unnamed-chunk-49-1.svg" width="480" style="display: block; margin: auto;" /></p>
<hr />
<p><strong>Problem 4</strong>)</p>
<p><strong>a)</strong> Beregn de samme opsummeringsstatistikker som i <strong>2</strong>), men brug <code>group_by()</code> for at opdele efter <strong>både</strong> variablerne <code>Pclass</code> og <code>Sex</code> først.</p>
<ul>
<li>OBS! Du får advarseln at “<code>summarise()</code> has grouped output by ‘Pclass’ …”, fordi din dataframe stadig betragtes som opdelt efter <code>Pclass</code>. Dette skal tages i betragtning, hvis du foretager yderligere beregninger på den.</li>
<li>Brug til sidst <code>ungroup()</code> på din nye dataframe for at sikre, at den ikke længere er opdelt efter nogen variabel.</li>
</ul>
<p><strong>b)</strong> Brug <code>pivot_longer()</code>-funktionen til at omdanne datasættet til long-formatet med opsummeringsstatistikker i en enkelt kolonne. Nøglekolonnen skal hedde <code>stat</code>, og kolonnen med værdierne skal hedde <code>values</code>.</p>
<p><strong>c)</strong> Lav et plot af alle opsummeringsstatistikker, som er i long-formatet.</p>
<p><img src="06-tidyverse2_files/figure-html/unnamed-chunk-52-1.svg" width="672" style="display: block; margin: auto;" /></p>
<hr />
<p><strong>Problem 5</strong>) <em><code>group_by()</code> med tre variabler og <code>summarise()</code></em>.</p>
<p>Prøv en kombination med tre forskellige variabler (vælg selv) indenfor <code>group_by()</code> og brug <code>summarise()</code> til at beregne gennemsnittet af variablen <code>Fare</code>.</p>
<ul>
<li>Anvend <code>ungroup()</code> når du er færdig med at opsummere</li>
<li>Lav et plot for at visualisere <code>meanFare</code>. Idé: som en mulighed, kan man tilføje variabler til <code>facet_grid()</code> - for eksempel <code>facet_grid(~Var1 + Var2)</code>.</li>
</ul>
<hr />
<p><strong>Problem 6</strong>) <em><code>pivot_longer()</code></em></p>
<p>Først skal du lave to nye variabler baseret på <code>SibSp</code> og <code>Parch</code> med “yes”-resultatet hvis værdien er større end 0. Brug derefter <code>select()</code> på <code>Fare</code>, <code>Age</code> og dine to nye variabler. Lav derefter følgende plot:</p>
<p><img src="06-tidyverse2_files/figure-html/unnamed-chunk-54-1.svg" width="672" style="display: block; margin: auto;" /></p>
<hr />
<p><strong>Problem 7</strong>) <em><code>Pivot_wider()</code></em></p>
<p>Vi bil gerne anvender en <code>tribble</code>, som vi kopierer fra <a href="https://r4ds.had.co.nz/index.html" class="uri">https://r4ds.had.co.nz/index.html</a>.</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="data2.html#cb365-1" tabindex="-1"></a>people <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb365-2"><a href="data2.html#cb365-2" tabindex="-1"></a>  <span class="sc">~</span>name,             <span class="sc">~</span>names,  <span class="sc">~</span>values,</span>
<span id="cb365-3"><a href="data2.html#cb365-3" tabindex="-1"></a>  <span class="co">#-----------------|--------|------</span></span>
<span id="cb365-4"><a href="data2.html#cb365-4" tabindex="-1"></a>  <span class="st">&quot;Phillip Woods&quot;</span>,   <span class="st">&quot;age&quot;</span>,       <span class="dv">45</span>,</span>
<span id="cb365-5"><a href="data2.html#cb365-5" tabindex="-1"></a>  <span class="st">&quot;Phillip Woods&quot;</span>,   <span class="st">&quot;height&quot;</span>,   <span class="dv">186</span>,</span>
<span id="cb365-6"><a href="data2.html#cb365-6" tabindex="-1"></a>  <span class="st">&quot;Jessica Cordero&quot;</span>, <span class="st">&quot;age&quot;</span>,       <span class="dv">37</span>,</span>
<span id="cb365-7"><a href="data2.html#cb365-7" tabindex="-1"></a>  <span class="st">&quot;Jessica Cordero&quot;</span>, <span class="st">&quot;height&quot;</span>,   <span class="dv">156</span>,</span>
<span id="cb365-8"><a href="data2.html#cb365-8" tabindex="-1"></a>  <span class="st">&quot;Brady Smith&quot;</span>,     <span class="st">&quot;age&quot;</span>,       <span class="dv">23</span>,</span>
<span id="cb365-9"><a href="data2.html#cb365-9" tabindex="-1"></a>  <span class="st">&quot;Brady Smith&quot;</span>,     <span class="st">&quot;height&quot;</span>,   <span class="dv">177</span></span>
<span id="cb365-10"><a href="data2.html#cb365-10" tabindex="-1"></a>)</span></code></pre></div>
<p>Brug <code>pivot_wider()</code> på <code>people</code> for at får datasættet i wide-formatet så at <code>age</code> og <code>height</code> hver har deres egne kolonner.</p>
<hr />
<p><strong>Problem 8</strong>) <em><code>left_join()</code> øvelse</em>.</p>
<p>Kør følgende kode med to tribbles:</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="data2.html#cb366-1" tabindex="-1"></a>superheroes <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb366-2"><a href="data2.html#cb366-2" tabindex="-1"></a>       <span class="sc">~</span>name, <span class="sc">~</span>alignment,  <span class="sc">~</span>gender,          <span class="sc">~</span>publisher,</span>
<span id="cb366-3"><a href="data2.html#cb366-3" tabindex="-1"></a>   <span class="st">&quot;Magneto&quot;</span>,      <span class="st">&quot;bad&quot;</span>,   <span class="st">&quot;male&quot;</span>,            <span class="st">&quot;Marvel&quot;</span>,</span>
<span id="cb366-4"><a href="data2.html#cb366-4" tabindex="-1"></a>     <span class="st">&quot;Storm&quot;</span>,     <span class="st">&quot;good&quot;</span>, <span class="st">&quot;female&quot;</span>,            <span class="st">&quot;Marvel&quot;</span>,</span>
<span id="cb366-5"><a href="data2.html#cb366-5" tabindex="-1"></a>  <span class="st">&quot;Mystique&quot;</span>,      <span class="st">&quot;bad&quot;</span>, <span class="st">&quot;female&quot;</span>,            <span class="st">&quot;Marvel&quot;</span>,</span>
<span id="cb366-6"><a href="data2.html#cb366-6" tabindex="-1"></a>    <span class="st">&quot;Batman&quot;</span>,     <span class="st">&quot;good&quot;</span>,   <span class="st">&quot;male&quot;</span>,                <span class="st">&quot;DC&quot;</span>,</span>
<span id="cb366-7"><a href="data2.html#cb366-7" tabindex="-1"></a>     <span class="st">&quot;Joker&quot;</span>,      <span class="st">&quot;bad&quot;</span>,   <span class="st">&quot;male&quot;</span>,                <span class="st">&quot;DC&quot;</span>,</span>
<span id="cb366-8"><a href="data2.html#cb366-8" tabindex="-1"></a>  <span class="st">&quot;Catwoman&quot;</span>,      <span class="st">&quot;bad&quot;</span>, <span class="st">&quot;female&quot;</span>,                <span class="st">&quot;DC&quot;</span>,</span>
<span id="cb366-9"><a href="data2.html#cb366-9" tabindex="-1"></a>   <span class="st">&quot;Hellboy&quot;</span>,     <span class="st">&quot;good&quot;</span>,   <span class="st">&quot;male&quot;</span>, <span class="st">&quot;Dark Horse Comics&quot;</span></span>
<span id="cb366-10"><a href="data2.html#cb366-10" tabindex="-1"></a>  )</span>
<span id="cb366-11"><a href="data2.html#cb366-11" tabindex="-1"></a></span>
<span id="cb366-12"><a href="data2.html#cb366-12" tabindex="-1"></a>publishers <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb366-13"><a href="data2.html#cb366-13" tabindex="-1"></a>  <span class="sc">~</span>publisher, <span class="sc">~</span>yr_founded,</span>
<span id="cb366-14"><a href="data2.html#cb366-14" tabindex="-1"></a>        <span class="st">&quot;DC&quot;</span>,       <span class="dv">1934</span><span class="dt">L</span>,</span>
<span id="cb366-15"><a href="data2.html#cb366-15" tabindex="-1"></a>    <span class="st">&quot;Marvel&quot;</span>,       <span class="dv">1939</span><span class="dt">L</span>,</span>
<span id="cb366-16"><a href="data2.html#cb366-16" tabindex="-1"></a>     <span class="st">&quot;Image&quot;</span>,       <span class="dv">1992</span><span class="dt">L</span></span>
<span id="cb366-17"><a href="data2.html#cb366-17" tabindex="-1"></a>  )</span></code></pre></div>
<p>Vi har to dataframes - <code>superheroes</code> og <code>publishers</code>. Hvilken kolonne kan man bruge til at forbinde de to? Brug <code>left_join()</code> til at tilføje oplysninger <strong>fra</strong> <code>publishers</code> <strong>til</strong> dataframen <code>superheroes</code>.</p>
<ul>
<li>Får man alle observationerne fra dataframen <code>superheroes</code> med i din nye dataframe?</li>
<li>Brug <code>inner_join()</code> til at forbinde <code>publishers</code> med <code>superheroes</code> - få man så nu alle observationer med denne gang?</li>
<li>Brug <code>full_join()</code> til at forbinde <code>publishers</code> med <code>superheroes</code> - hvor mange observationer få man med nu? Hvorfor?</li>
</ul>
<hr />
<p><strong>Problem 9</strong>) <em><code>left_join()</code> øvelse</em>.</p>
<p>Kør nedenstående kode, hvor der er to dataframes - <code>iris2</code> og <code>sample_table</code>. Dataframen <code>iris2</code> er ikke særlig informativ med hensyn til kilden af de forskellige prøver. Men mere oplysningerne findes i <code>sample_table</code>. Brug <code>left_join()</code> til at tilføje <code>sample_table</code> til <code>iris2</code> for at få en dataframe, som indeholder både data og oplysninger om prøverne.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="data2.html#cb367-1" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb367-2"><a href="data2.html#cb367-2" tabindex="-1"></a>iris2 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(iris)</span>
<span id="cb367-3"><a href="data2.html#cb367-3" tabindex="-1"></a><span class="fu">names</span>(iris2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sample1&quot;</span>,<span class="st">&quot;sample2&quot;</span>,<span class="st">&quot;sample3&quot;</span>,<span class="st">&quot;sample4&quot;</span>,<span class="st">&quot;Species&quot;</span>)</span>
<span id="cb367-4"><a href="data2.html#cb367-4" tabindex="-1"></a></span>
<span id="cb367-5"><a href="data2.html#cb367-5" tabindex="-1"></a>samp_table <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb367-6"><a href="data2.html#cb367-6" tabindex="-1"></a>                      <span class="sc">~</span>sample, <span class="sc">~</span>part, <span class="sc">~</span>measure,</span>
<span id="cb367-7"><a href="data2.html#cb367-7" tabindex="-1"></a>                      <span class="co">#------|-------|--------#</span></span>
<span id="cb367-8"><a href="data2.html#cb367-8" tabindex="-1"></a>                      <span class="st">&quot;sample1&quot;</span>, <span class="st">&quot;Sepal&quot;</span>, <span class="st">&quot;Length&quot;</span>,</span>
<span id="cb367-9"><a href="data2.html#cb367-9" tabindex="-1"></a>                      <span class="st">&quot;sample2&quot;</span>, <span class="st">&quot;Sepal&quot;</span>, <span class="st">&quot;Width&quot;</span>,</span>
<span id="cb367-10"><a href="data2.html#cb367-10" tabindex="-1"></a>                      <span class="st">&quot;sample3&quot;</span>, <span class="st">&quot;Petal&quot;</span>, <span class="st">&quot;Length&quot;</span>,</span>
<span id="cb367-11"><a href="data2.html#cb367-11" tabindex="-1"></a>                      <span class="st">&quot;sample4&quot;</span>, <span class="st">&quot;Sepal&quot;</span>, <span class="st">&quot;Width&quot;</span></span>
<span id="cb367-12"><a href="data2.html#cb367-12" tabindex="-1"></a>                     )</span>
<span id="cb367-13"><a href="data2.html#cb367-13" tabindex="-1"></a></span>
<span id="cb367-14"><a href="data2.html#cb367-14" tabindex="-1"></a>iris2 <span class="sc">%&gt;%</span></span>
<span id="cb367-15"><a href="data2.html#cb367-15" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>#&gt; Rows: 150
#&gt; Columns: 5
#&gt; $ sample1 &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.8, 4.…
#&gt; $ sample2 &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.4, 3.…
#&gt; $ sample3 &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.5, 1.6, 1.…
#&gt; $ sample4 &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.2, 0.…
#&gt; $ Species &lt;fct&gt; setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa…</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="data2.html#cb369-1" tabindex="-1"></a>samp_table <span class="sc">%&gt;%</span></span>
<span id="cb369-2"><a href="data2.html#cb369-2" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>#&gt; Rows: 4
#&gt; Columns: 3
#&gt; $ sample  &lt;chr&gt; &quot;sample1&quot;, &quot;sample2&quot;, &quot;sample3&quot;, &quot;sample4&quot;
#&gt; $ part    &lt;chr&gt; &quot;Sepal&quot;, &quot;Sepal&quot;, &quot;Petal&quot;, &quot;Sepal&quot;
#&gt; $ measure &lt;chr&gt; &quot;Length&quot;, &quot;Width&quot;, &quot;Length&quot;, &quot;Width&quot;</code></pre>
<hr />
<p><strong>Problem 10</strong>) <em><code>Separate()</code> øvelse</em></p>
<ul>
<li>Tag udgangspunkt i datasættet <code>titanic_clean</code> og brug <code>separate()</code> til at opdele variablen <code>Name</code> i to variabler, <code>Surname</code> og <code>Rest</code> (Godt råd: brug <code>sep=", "</code> for at undgå, at man får et unødvendigt mellemrum lige før <code>Rest</code>).</li>
<li>Anvend <code>separate()</code> en gang til, men for at opdele variablen <code>Rest</code> i to variabler, <code>Titel</code> og <code>Names</code>. Hvad bruger man som <code>sep</code>? (Hint: brug “\\” foran en punktum).</li>
<li>Beregn opsummeringsstatistikker for hver <code>Titel</code> - antal passagerer, gennemsnitsalder, andelen der overlevede og andelen der rejste i første klasse.</li>
<li>Arrangere din nye dataframe efter, hvor mange personer der er for hver <code>Titel</code> - flest øverst og færrest nederst.</li>
</ul>
<hr />
<p><strong>Problem 11</strong>) <em>Ekstra pivot_longer() øvelse</em></p>
<p>Åbn datasættet <code>airquality</code> (<code>data(airquality)</code>) og lav følgende plot:</p>
<p><img src="06-tidyverse2_files/figure-html/unnamed-chunk-66-1.svg" width="672" style="display: block; margin: auto;" /></p>
<hr />
<p><strong>Problem 12</strong>)</p>
<p>Åbn <code>table2</code> (<code>data(table2)</code>) og reshape den til:</p>
<pre><code>#&gt; # A tibble: 6 × 4
#&gt;   country      year  cases population
#&gt;   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
#&gt; 1 Afghanistan  1999    745   19987071
#&gt; 2 Afghanistan  2000   2666   20595360
#&gt; 3 Brazil       1999  37737  172006362
#&gt; 4 Brazil       2000  80488  174504898
#&gt; 5 China        1999 212258 1272915272
#&gt; 6 China        2000 213766 1280428583</code></pre>
<hr />
<p><strong>Problem 13</strong>)</p>
<p>Tag udgangspunkt i <code>my_tibble</code>:</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="data2.html#cb372-1" tabindex="-1"></a>cause <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Communicable diseases&quot;</span>,<span class="st">&quot;Injuries&quot;</span>,<span class="st">&quot;Non-communicable diseases&quot;</span>),<span class="at">each=</span><span class="dv">4</span>)</span>
<span id="cb372-2"><a href="data2.html#cb372-2" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1990</span>,<span class="dv">2017</span>),<span class="at">times=</span><span class="dv">6</span>)</span>
<span id="cb372-3"><a href="data2.html#cb372-3" tabindex="-1"></a>sex <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Male&quot;</span>),<span class="at">times=</span><span class="dv">3</span>)</span>
<span id="cb372-4"><a href="data2.html#cb372-4" tabindex="-1"></a>deaths_millions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">7.30</span>,<span class="fl">4.91</span>,<span class="fl">8.06</span>,<span class="fl">5.47</span>,<span class="fl">1.41</span>,<span class="fl">1.42</span>,<span class="fl">2.84</span>,<span class="fl">3.05</span>,<span class="fl">12.80</span>,<span class="fl">19.15</span>,<span class="fl">13.91</span>,<span class="fl">21.74</span>)</span>
<span id="cb372-5"><a href="data2.html#cb372-5" tabindex="-1"></a></span>
<span id="cb372-6"><a href="data2.html#cb372-6" tabindex="-1"></a>my_tibble <span class="ot">&lt;-</span> <span class="fu">tibble</span>(cause,year,sex,deaths_millions)</span></code></pre></div>
<p>Og reshape den til (tip: Google efter <code>unite()</code> for at se den forbundene syntax):</p>
<pre><code>#&gt; # A tibble: 3 × 5
#&gt;   cause                     Female_1990 Female_2017 Male_1990 Male_2017
#&gt;   &lt;chr&gt;                           &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
#&gt; 1 Communicable diseases            7.3         4.91      8.06      5.47
#&gt; 2 Injuries                         1.41        1.42      2.84      3.05
#&gt; 3 Non-communicable diseases       12.8        19.2      13.9      21.7</code></pre>
<p><strong>Problem 14</strong>)</p>
<p>Valgfri ekstra: lav en ny dataframe med alle passagerer, der hedder “Alice” eller “Elizabeth” (brug Google her).</p>
<hr />
</div>
<div id="ekstra-links-1" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Ekstra links<a href="data2.html#ekstra-links-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Cheatsheet: <a href="https://github.com/rstudio/cheatsheets/blob/master/data-import.pdf" class="uri">https://github.com/rstudio/cheatsheets/blob/master/data-import.pdf</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functional-programming-med-purrr-pakken.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/USERNAME/REPO/edit/BRANCH/06-tidyverse2.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
